<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day 0 with GCP (Google Cloud) | @abiydv</title>
<meta name=keywords content="gcp,terraform,gcloud"><meta name=description content="Get started quick with GCP/Google Cloud"><meta name=author content><link rel=canonical href=https://abiydv.github.io/posts/day0-gcp/><link crossorigin=anonymous href=/assets/css/stylesheet.c5edd088d0c984c192170cfbab7d2de030010ee0b7d771bd6bca049dd2332874.css integrity="sha256-xe3QiNDJhMGSFwz7q30t4DABDuC313G9a8oEndIzKHQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://abiydv.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://abiydv.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://abiydv.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://abiydv.github.io/apple-touch-icon.png><link rel=mask-icon href=https://abiydv.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://abiydv.github.io/posts/day0-gcp/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="Day 0 with GCP (Google Cloud)"><meta property="og:description" content="Get started quick with GCP/Google Cloud"><meta property="og:type" content="article"><meta property="og:url" content="https://abiydv.github.io/posts/day0-gcp/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-11-15T00:00:00+00:00"><meta property="article:modified_time" content="2020-11-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Day 0 with GCP (Google Cloud)"><meta name=twitter:description content="Get started quick with GCP/Google Cloud"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://abiydv.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Day 0 with GCP (Google Cloud)","item":"https://abiydv.github.io/posts/day0-gcp/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day 0 with GCP (Google Cloud)","name":"Day 0 with GCP (Google Cloud)","description":"Get started quick with GCP/Google Cloud","keywords":["gcp","terraform","gcloud"],"articleBody":"Introduction GCP or Google Cloud Platform is quickly emerging as a major force in the public cloud space. It is at no.3 right now by marketshare(7%) behind AWS(32%) and Azure (19%)1. As per the 2020 Magic Quadrant report, it is very close to bridging the gap with the other 2 leaders2.\nIn this series, We will setup a free tier GCP account and explore some of the services by creating some basic projects.\nThe first step is to enroll yourself for the free GCP account (with $300 credit - 90 days). You do need a credit card to sign-up but Google assures, it won‚Äôt be charged until you enable the automatic billing in the console (a safety net of sorts?). You can use the free tier services without this turned on, however, there are some services which will ask you to enable this billing thing before proceeding.\nGCP Basics This https://cloud.google.com/docs/overview is a good starting point to undrstanding more about the layout of a typical GCP account and its different sections. If you are familier with any of the other clouds (AWS or Azure), these pages https://cloud.google.com/docs/compare/aws, https://cloud.google.com/docs/compare/azure can help you understand the corresponding GCP service offerings.\nFirst Exercise We will keep this fairly simple. It will involve\nSetting up a free account Configuring and understanding gcloud cli Enabling some googleapis to work with - like compute, iam etc. Setting up a new project Setting up permissions and service-accounts Creating a storage bucket with versioning Creating a new instance in the default network topology Cleanup - deleting all resources. gcloud is the cli to work with GCP. It can be run either directly on the browser or locally after installing Cloud SDK.\nGCP has an extra concept of ‚Äúenabling/disabling‚Äù APIs. This is a prerequisite before you can use any service.\nSteps Now we will go through the steps to complete the aforementioned tasks. I am not including the tasks for creating a account, and adding your billing information here.\n1. Create a new project In GCP, resources are logically separated under projects. Think of it as a namespace. Resources in one project don‚Äôt have access to resources in other projects by default. There are ways to allow this, but that‚Äôs for a later post.\nRemember to assign a unique project-id\n1$ gcloud projects create tools-202011 2. Associate the new project to an active billing account 1$ gcloud alpha billing projects link tools-202011 --billing-account 01132C-383548-8543A6 3. Create a new service account This will be used by Terraform to provision resources. A separate service account ensures that it‚Äôs permissions can be tightly controlled.\nNote the service account email full string, will be needed in the later steps.\n1$ gcloud iam service-accounts create tools-service-account 2$ gcloud iam service-accounts list 3DISPLAY NAME EMAIL DISABLED 4tools-service-account@tools-202011.iam.gserviceaccount.com False 4. Create a key for the service account 1$ gcloud iam service-accounts keys create --iam-account tools-service-account@tools-202011.iam.gserviceaccount.com tools-service-account.json 5. Attach permissions to the service account Allow access on compute and storage googleapis by attaching existing roles.\n1$ gcloud projects add-iam-policy-binding tools-202011 --member serviceAccount:tools-service-account@tools-202011.iam.gserviceaccount.com --role roles/storage.admin 2 3$ gcloud projects add-iam-policy-binding tools-202011 --member serviceAccount:tools-service-account@tools-202011.iam.gserviceaccount.com --role roles/compute.admin 6. Enable necessary APIs This will need to be enabled before we can use these services and it‚Äôs APIs.\n1$ gcloud services enable cloudresourcemanager.googleapis.com 2$ gcloud services enable cloudbilling.googleapis.com 3$ gcloud services enable iam.googleapis.com 4$ gcloud services enable compute.googleapis.com 5$ gcloud services enable serviceusage.googleapis.com 7. Create Storage Bucket This will be used for terraform remote state, so enable versioning as well. For working with the storage buckets the cli to use is gsutil\n1$ gsutil mb -p tools-202011 gs://tools-202011 2$ gsutil versioning set on gs://tools-202011 8. Run terraform With all the prerequisites completed, we can now setup terraform to work with GCP.\nDownload the latest terraform installer from here, the basic terraform template from here\nNext, we need to provide credentials to terraform. Export the environment variable GOOGLE_APPLICATION_CREDENTIALS=tools-service-account.json. The json provided here is created in the step-4 above with the service account.\nNow we can run the terraform commands to launch our instance.\n1$ terraform init 2$ terraform apply Type Yes when prompted. The instance will be ready in a few mins. Next, validate the resources that are created so far.\n9. Validate We can validate what resources have been creating either from the console or gcloud cli. Use these command to verify the resources are created as expected -\nInstance and disk created\n1$ gcloud compute instances list --filter=\"zone:us-central1-a\" 2NAME ZONE MACHINE_TYPE PREEMPTIBLE INTERNAL_IP EXTERNAL_IP STATUS 3tf-compute-1 us-central1-a f1-micro 10.128.0.21 104.154.265.8 RUNNING 4 5$ gcloud compute disks list --filter=\"zone:us-central1-a\" 6NAME LOCATION LOCATION_SCOPE SIZE_GB TYPE STATUS 7tf-compute-1 us-central1-a zone 10 pd-standard READY Storage bucket and terraform state file created\n1$ gsutil ls -r gs://tools-202011/* 2gs://tools-202011/terraform/: 3 4gs://tools-202011/terraform/day0-state/: 5gs://tools-202011/terraform/day0-state/default.tfstate Finally, let‚Äôs SSH to this new instance using gcloud console\n1$ gcloud compute ssh tf-compute-1 --zone us-central1-a Note: If gcloud can‚Äôt find a ssh-keypair in your home directory it will prompt you to create one first, and then connect to the instance using it.\nGCP handles the SSH keypairs a bit differently in the sense that, they are tied to a project. The keys are picked up from the instance metadata. You can inspect the available keys by requesting this from within an instance\n1$ curl http://metadata.google.internal/computeMetadata/v1/project/attributes/ssh-keys -H\"Metadata-Flavor: Google\" 2abiydv:ssh-rsa AAAAB3Nza......... 3...........abiydv@tf-compute-1:~$ 10. Cleanup Remove all the resources created so far.\n1$ terraform destroy --auto-approve Conclusion This was a simple exercise suitable to develop a basic understanding of GCP - creating a free tier account, understanding the layout, some key services like iam, storage, compute etc, using/configuring the cli - gcloud and finally, using terraform with GCP.\nIn the next few posts, we will build on this and also explore other services, use-cases etc. üëç\nNote:¬†Code mentioned above is here¬†References (4) Gcp Free Tier¬†Gcloud¬†Managing Gcp Projects With Terraform¬†Connecting to Instance¬†https://www.canalys.com/newsroom/worldwide-cloud-market-q320¬†‚Ü©Ô∏é\nhttps://cloud.google.com/gartner-cloud-infrastructure-as-a-service¬†‚Ü©Ô∏é\n","wordCount":"971","inLanguage":"en","datePublished":"2020-11-15T00:00:00Z","dateModified":"2020-11-15T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://abiydv.github.io/posts/day0-gcp/"},"publisher":{"@type":"Organization","name":"@abiydv","logo":{"@type":"ImageObject","url":"https://abiydv.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://abiydv.github.io/ accesskey=h title="@abiydv (Alt + H)">@abiydv</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://abiydv.github.io/ title=Home><span>Home</span></a></li><li><a href=https://abiydv.github.io/about/ title=About><span>About</span></a></li><li><a href=https://abiydv.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://abiydv.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://abiydv.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://abiydv.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://abiydv.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://abiydv.github.io/posts/>Posts</a></div><h1 class=post-title>Day 0 with GCP (Google Cloud)</h1><div class=post-description>Get started quick with GCP/Google Cloud</div><div class=post-meta>15.11.20 / Posts / 5 min</div></header><div class=post-content><h2 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h2><p>GCP or Google Cloud Platform is quickly emerging as a major force in the public cloud space. It is at no.3 right now by marketshare(7%) behind AWS(32%) and Azure (19%)<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. As per the 2020 Magic Quadrant report, it is very close to bridging the gap with the other 2 leaders<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>In this series, We will setup a free tier GCP account and explore some of the services by creating some basic projects.</p><p>The first step is to enroll yourself for the free GCP account (with $300 credit - 90 days). You do need a credit card to sign-up but Google assures, it won&rsquo;t be charged until you enable the automatic billing in the console (a safety net of sorts?). You can use the free tier services without this turned on, however, there are some services which will ask you to enable this billing thing before proceeding.</p><h2 id=gcp-basics>GCP Basics<a hidden class=anchor aria-hidden=true href=#gcp-basics>#</a></h2><p>This <a href=https://cloud.google.com/docs/overview>https://cloud.google.com/docs/overview</a> is a good starting point to undrstanding more about the layout of a typical GCP account and its different sections. If you are familier with any of the other clouds (AWS or Azure), these pages <a href=https://cloud.google.com/docs/compare/aws>https://cloud.google.com/docs/compare/aws</a>, <a href=https://cloud.google.com/docs/compare/azure>https://cloud.google.com/docs/compare/azure</a> can help you understand the corresponding GCP service offerings.</p><h2 id=first-exercise>First Exercise<a hidden class=anchor aria-hidden=true href=#first-exercise>#</a></h2><p>We will keep this fairly simple. It will involve</p><ul><li>Setting up a free account</li><li>Configuring and understanding <code>gcloud</code> cli</li><li>Enabling some googleapis to work with - like compute, iam etc.</li><li>Setting up a new project</li><li>Setting up permissions and service-accounts</li><li>Creating a storage bucket with versioning</li><li>Creating a new instance in the default network topology</li><li>Cleanup - deleting all resources.</li></ul><p><code>gcloud</code> is the cli to work with GCP. It can be run either directly on the browser or locally after installing <a href="https://cloud.google.com/sdk/docs/quickstart?hl=en_US">Cloud SDK</a>.</p><p>GCP has an extra concept of &ldquo;enabling/disabling&rdquo; APIs. This is a prerequisite before you can use any service.</p><h2 id=steps>Steps<a hidden class=anchor aria-hidden=true href=#steps>#</a></h2><p>Now we will go through the steps to complete the aforementioned tasks. I am not including the tasks for creating a account, and adding your billing information here.</p><h3 id=1-create-a-new-project>1. Create a new project<a hidden class=anchor aria-hidden=true href=#1-create-a-new-project>#</a></h3><p>In GCP, resources are logically separated under projects. Think of it as a namespace. Resources in one project don&rsquo;t have access to resources in other projects by default. There are ways to allow this, but that&rsquo;s for a later post.</p><p>Remember to assign a unique project-id</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud projects create tools-202011
</span></span></code></pre></div><h3 id=2-associate-the-new-project-to-an-active-billing-account>2. Associate the new project to an active billing account<a hidden class=anchor aria-hidden=true href=#2-associate-the-new-project-to-an-active-billing-account>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud alpha billing projects link  tools-202011 --billing-account 01132C-383548-8543A6
</span></span></code></pre></div><h3 id=3-create-a-new-service-account>3. Create a new service account<a hidden class=anchor aria-hidden=true href=#3-create-a-new-service-account>#</a></h3><p>This will be used by Terraform to provision resources. A separate service account ensures that it&rsquo;s permissions can be tightly controlled.</p><p>Note the service account email full string, will be needed in the later steps.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud iam service-accounts create tools-service-account
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>$ gcloud iam service-accounts list
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>DISPLAY NAME EMAIL                                          DISABLED
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>tools-service-account@tools-202011.iam.gserviceaccount.com  False
</span></span></code></pre></div><h3 id=4-create-a-key-for-the-service-account>4. Create a key for the service account<a hidden class=anchor aria-hidden=true href=#4-create-a-key-for-the-service-account>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud iam service-accounts keys create --iam-account tools-service-account@tools-202011.iam.gserviceaccount.com tools-service-account.json
</span></span></code></pre></div><h3 id=5-attach-permissions-to-the-service-account>5. Attach permissions to the service account<a hidden class=anchor aria-hidden=true href=#5-attach-permissions-to-the-service-account>#</a></h3><p>Allow access on compute and storage googleapis by attaching existing roles.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud projects add-iam-policy-binding tools-202011 --member serviceAccount:tools-service-account@tools-202011.iam.gserviceaccount.com --role roles/storage.admin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>$ gcloud projects add-iam-policy-binding tools-202011 --member serviceAccount:tools-service-account@tools-202011.iam.gserviceaccount.com --role roles/compute.admin
</span></span></code></pre></div><h3 id=6-enable-necessary-apis>6. Enable necessary APIs<a hidden class=anchor aria-hidden=true href=#6-enable-necessary-apis>#</a></h3><p>This will need to be enabled before we can use these services and it&rsquo;s APIs.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud services enable cloudresourcemanager.googleapis.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>$ gcloud services enable cloudbilling.googleapis.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>$ gcloud services enable iam.googleapis.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>$ gcloud services enable compute.googleapis.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>$ gcloud services enable serviceusage.googleapis.com
</span></span></code></pre></div><h3 id=7-create-storage-bucket>7. Create Storage Bucket<a hidden class=anchor aria-hidden=true href=#7-create-storage-bucket>#</a></h3><p>This will be used for terraform remote state, so enable versioning as well. For working with the storage buckets the cli to use is <code>gsutil</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gsutil mb -p tools-202011 gs://tools-202011
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>$ gsutil versioning set on gs://tools-202011
</span></span></code></pre></div><h3 id=8-run-terraform>8. Run terraform<a hidden class=anchor aria-hidden=true href=#8-run-terraform>#</a></h3><p>With all the prerequisites completed, we can now setup <code>terraform</code> to work with GCP.</p><p>Download the latest terraform installer from <a href=https://www.terraform.io/downloads.html>here</a>, the basic terraform template from <a href=https://github.com/abiydv/learn-gcp/tree/master/day-0>here</a></p><p>Next, we need to provide credentials to <code>terraform</code>. Export the environment variable <code>GOOGLE_APPLICATION_CREDENTIALS=tools-service-account.json</code>. The json provided here is created in the step-4 above with the service account.</p><p>Now we can run the <code>terraform</code> commands to launch our instance.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ terraform init
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>$ terraform apply
</span></span></code></pre></div><p>Type <code>Yes</code> when prompted. The instance will be ready in a few mins. Next, validate the resources that are created so far.</p><h3 id=9-validate>9. Validate<a hidden class=anchor aria-hidden=true href=#9-validate>#</a></h3><p>We can validate what resources have been creating either from the console or <code>gcloud</code> cli. Use these command to verify the resources are created as expected -</p><p><em>Instance and disk created</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud compute instances list --filter<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;zone:us-central1-a&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>NAME          ZONE           MACHINE_TYPE  PREEMPTIBLE  INTERNAL_IP  EXTERNAL_IP     STATUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>tf-compute-1  us-central1-a  f1-micro                   10.128.0.21   104.154.265.8  RUNNING
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>$ gcloud compute disks list --filter<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;zone:us-central1-a&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>NAME          LOCATION       LOCATION_SCOPE  SIZE_GB  TYPE         STATUS
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>tf-compute-1  us-central1-a  zone            <span style=color:#ae81ff>10</span>       pd-standard  READY
</span></span></code></pre></div><p><em>Storage bucket and terraform state file created</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gsutil ls -r gs://tools-202011/*
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>gs://tools-202011/terraform/:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>gs://tools-202011/terraform/day0-state/:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>gs://tools-202011/terraform/day0-state/default.tfstate
</span></span></code></pre></div><p>Finally, let&rsquo;s SSH to this new instance using <code>gcloud</code> console</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ gcloud compute ssh tf-compute-1 --zone us-central1-a
</span></span></code></pre></div><p><strong>Note</strong>: If <code>gcloud</code> can&rsquo;t find a ssh-keypair in your home directory it will prompt you to create one first, and then connect to the instance using it.</p><p>GCP handles the SSH keypairs a bit differently in the sense that, they are tied to a project. The keys are picked up from the instance metadata. You can inspect the available keys by requesting this from within an instance</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ curl http://metadata.google.internal/computeMetadata/v1/project/attributes/ssh-keys -H<span style=color:#e6db74>&#34;Metadata-Flavor: Google&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>abiydv:ssh-rsa AAAAB3Nza.........
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>...........abiydv@tf-compute-1:~$
</span></span></code></pre></div><h3 id=10-cleanup>10. Cleanup<a hidden class=anchor aria-hidden=true href=#10-cleanup>#</a></h3><p>Remove all the resources created so far.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ terraform destroy --auto-approve
</span></span></code></pre></div><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>This was a simple exercise suitable to develop a basic understanding of GCP - creating a free tier account, understanding the layout, some key services like iam, storage, compute etc, using/configuring the cli - <code>gcloud</code> and finally, using <code>terraform</code> with GCP.</p><p>In the next few posts, we will build on this and also explore other services, use-cases etc. &#x1f44d;</p><b>Note:</b>&nbsp;
Code mentioned above is
<a aria-label="link to https://github.com/abiydv/learn-gcp" target=_blank href=https://github.com/abiydv/learn-gcp>here&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg><h2>References (4)</h2><ol class=slimlist-ol><li class=slimlist-ol><a aria-label="link to * https://cloud.google.com/free/docs/gcp-free-tier" target=_blank href=#ZgotmplZ>Gcp Free Tier&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li class=slimlist-ol><a aria-label="link to * https://cloud.google.com/sdk/gcloud" target=_blank href=#ZgotmplZ>Gcloud&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li class=slimlist-ol><a aria-label="link to * https://cloud.google.com/community/tutorials/managing-gcp-projects-with-terraform" target=_blank href=#ZgotmplZ>Managing Gcp Projects With Terraform&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li class=slimlist-ol><a aria-label="link to * https://cloud.google.com/compute/docs/instances/connecting-to-instance" target=_blank href=#ZgotmplZ>Connecting to Instance&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ol><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.canalys.com/newsroom/worldwide-cloud-market-q320>https://www.canalys.com/newsroom/worldwide-cloud-market-q320</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://cloud.google.com/gartner-cloud-infrastructure-as-a-service>https://cloud.google.com/gartner-cloud-infrastructure-as-a-service</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><footer class=post-footer><hr><div class=align-center><div class=slimlist-entry><h2>Tags</h2></div><ul class=post-tags><div class=slimlist-entry><li class=post-tags><a href=https://abiydv.github.io/tags/gcp/>gcp</a></li><li class=post-tags><a href=https://abiydv.github.io/tags/terraform/>terraform</a></li><li class=post-tags><a href=https://abiydv.github.io/tags/gcloud/>gcloud</a></li></div></ul></div></footer><script src=https://utteranc.es/client.js repo=abiydv/abiydv.github.io issue-term=title label=Comment theme=github-light crossorigin=anonymous async></script><hr><div class=align-left><div class=slimlist-entry><h2>Related</h2></div><ul class=slimlist><li class=slimlist><div class=slimlist-entry><h3 class=slimlist-entry-title><a aria-label="post link to Day 1 with GCP - Cloud Functions" href=https://abiydv.github.io/posts/day1-gcp-cloud-functions/>Day 1 with GCP - Cloud Functions</a></h3><div class=slimlist-meta>19.11.20 / Posts / 3 min</div></div></li><li class=slimlist><div class=slimlist-entry><h3 class=slimlist-entry-title><a aria-label="post link to Day 2 with GCP - Google Kubernetes Engine" href=https://abiydv.github.io/posts/day2-kubernetes-engine/>Day 2 with GCP - Google Kubernetes Engine</a></h3><div class=slimlist-meta>29.12.20 / Posts / 4 min</div></div></li><li class=slimlist><div class=slimlist-entry><h3 class=slimlist-entry-title><a aria-label="post link to Hashicorp Certified Terraform Associate - My Experience" href=https://abiydv.github.io/posts/certified-terraform-associate/>Hashicorp Certified Terraform Associate - My Experience</a></h3><div class=slimlist-meta>11.12.20 / Posts / 4 min</div></div></li></ul></div></article></main><footer class=footer><span>&copy; 2019-2025 <a href=https://abiydv.github.io/>@abiydv</a> / </span><span>Published 4.4.25 /
</span><span>Thanks <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>, <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>