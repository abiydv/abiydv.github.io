<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AWS Security Services | @abiydv</title>
<meta name=keywords content><meta name=description content="Security Hub Add details
AWS Inspector automated vulnerability management service that continually scans Amazon Elastic Compute Cloud (EC2)
AWS Lambda functions, and container images in Amazon ECR and within continuous integration and continuous delivery (CI/CD) tools, in near-real time for software vulnerabilities and unintended network exposure.
Common Vulnerability Scoring System (CVSS) v2 and v3 scores from both National Vulnerability Database (NVD) and vendors
manage software bill of materials (SBOM) exports for all monitored resources."><meta name=author content><link rel=canonical href=https://abiydv.github.io/notes/aws/security-services/><link crossorigin=anonymous href=/assets/css/stylesheet.c5edd088d0c984c192170cfbab7d2de030010ee0b7d771bd6bca049dd2332874.css integrity="sha256-xe3QiNDJhMGSFwz7q30t4DABDuC313G9a8oEndIzKHQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://abiydv.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://abiydv.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://abiydv.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://abiydv.github.io/apple-touch-icon.png><link rel=mask-icon href=https://abiydv.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://abiydv.github.io/notes/aws/security-services/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="AWS Security Services"><meta property="og:description" content="Security Hub Add details
AWS Inspector automated vulnerability management service that continually scans Amazon Elastic Compute Cloud (EC2)
AWS Lambda functions, and container images in Amazon ECR and within continuous integration and continuous delivery (CI/CD) tools, in near-real time for software vulnerabilities and unintended network exposure.
Common Vulnerability Scoring System (CVSS) v2 and v3 scores from both National Vulnerability Database (NVD) and vendors
manage software bill of materials (SBOM) exports for all monitored resources."><meta property="og:type" content="article"><meta property="og:url" content="https://abiydv.github.io/notes/aws/security-services/"><meta property="article:section" content="notes"><meta property="article:published_time" content="2024-02-15T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-05T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AWS Security Services"><meta name=twitter:description content="Security Hub Add details
AWS Inspector automated vulnerability management service that continually scans Amazon Elastic Compute Cloud (EC2)
AWS Lambda functions, and container images in Amazon ECR and within continuous integration and continuous delivery (CI/CD) tools, in near-real time for software vulnerabilities and unintended network exposure.
Common Vulnerability Scoring System (CVSS) v2 and v3 scores from both National Vulnerability Database (NVD) and vendors
manage software bill of materials (SBOM) exports for all monitored resources."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://abiydv.github.io/notes/"},{"@type":"ListItem","position":2,"name":"AWS","item":"https://abiydv.github.io/notes/aws/"},{"@type":"ListItem","position":3,"name":"AWS Security Services","item":"https://abiydv.github.io/notes/aws/security-services/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AWS Security Services","name":"AWS Security Services","description":"Security Hub Add details\nAWS Inspector automated vulnerability management service that continually scans Amazon Elastic Compute Cloud (EC2)\nAWS Lambda functions, and container images in Amazon ECR and within continuous integration and continuous delivery (CI/CD) tools, in near-real time for software vulnerabilities and unintended network exposure.\nCommon Vulnerability Scoring System (CVSS) v2 and v3 scores from both National Vulnerability Database (NVD) and vendors\nmanage software bill of materials (SBOM) exports for all monitored resources.","keywords":[],"articleBody":"Security Hub Add details\nAWS Inspector automated vulnerability management service that continually scans Amazon Elastic Compute Cloud (EC2)\nAWS Lambda functions, and container images in Amazon ECR and within continuous integration and continuous delivery (CI/CD) tools, in near-real time for software vulnerabilities and unintended network exposure.\nCommon Vulnerability Scoring System (CVSS) v2 and v3 scores from both National Vulnerability Database (NVD) and vendors\nmanage software bill of materials (SBOM) exports for all monitored resources.\nintegrates with Security Hub, AWS EventBridge to automate workflows and ticket routing\nintegrates with AWS Organizations for central management\nintegrates with SSM, and uses the same agent for it’s findings\nMacie discovers sensitive data using machine learning and pattern matching, provides visibility into data security risks, and enables automated protection\nenabled on a per-region basis\nmanaged data identifier = built-in criteria and techniques that are designed to detect a specific type of sensitive data\ncustom data identifier = define custom data patterns using regex for your unique usecase, for example, a particular format of employee email addresses or ids. You can also specify character sequences, such as words and phrases, and a proximity rule to refine the results.\nintegrates with Security Hub, AWS EventBridge\nintegrates with AWS Organizations to discover sensitive data across all accounts\nKMS Highly available key generation, storage, management, and auditing solution to encrypt or digitally sign data within applications or control the encryption of data across AWS services.\nEnable Private DNS Name makes the standard AWS KMS DNS hostname (https://kms.region.amazonaws.com) resolve to VPC endpoint.\nSupports Symmetric (256-bit key that is used for encryption and decryption) and Asymmetric CMKs (an RSA key pair that is used for encryption and decryption or signing and verification but not both, or an elliptic curve (ECC) key pair that is used for signing and verification).\nAsymmetric customer managed CMKs - the key material can only be generated within AWS KMS HSMs and no option for automatic key rotation.\nSymmetric CMKs and the private keys of Asymmetric CMKs never leave AWS KMS unencrypted and AWS KMS does not store, manage, or track data keys.\nCryptographic Operations\nDecrypt, Encrypt, GenerateDataKey, GenerateDataKeyPair, GenerateDataKeyPairWithoutPlaintext, GenerateDataKeyWithoutPlaintext, GenerateRandom, ReEncrypt, Sign, Verify GenerateRandom does not use any CMK. Customer Master Key (CMK)\nLogical representation of a master key. Includes metadata, such as the key ID, creation date, description, and key state. Contains the key material used to encrypt and decrypt data. Cannot be changed. Alias - friendly name. Can be used in KMS operations (including cryptographic). Use single alias to refer to different CMKs in different Region. Can add, change, and delete an alias without affecting the associated CMK. AWS Managed CMK\nPartial control. Track in account, choose which ones to use, track usage via Cloudtrail. Mandatory rotation in 1095 days/3 yrs. No monthly fee. Do not count against resource quotas on the number of CMKs in each Region. DescribeKey API response, the KeyManager value is AWS. Cannot edit the key policy. Customer Managed CMK\nFull control. Define access control and usage policy for each key, grant permissions to other accounts and services. Key material can be generated in KMS, CloudHSM or be from outside AWS. Optional rotation 365 days/1 yr. Incur a monthly fee and a fee for use in excess of the free tier. Counted against quota for number of CMKs in each Region. DescribeKey API response, the KeyManager value is Customer. Use key policy to add, remove, or change permissions at any time. AWS owned CMK\nCMKs that an AWS service owns and manages for use in multiple AWS accounts. Not in your AWS account but AWS service can use it to protect the resources in account. Key Rotation\nManual only - asymmetric, CMK with imported key material, CMKs in custom key stores (ex- using CloudHSM). Automatic - yearly for customer managed CMK (disabled by default). Key Deletion\nSchedule key deletion - 7 days (min) to 30 days (max, default). Key scheduled for deletion cannot be used for cryptographic operations. CMK with imported key material - can delete the key material immediately. CMK can be re-enabled by reimporting the key material. Deleted CMK may not impact mounted encrypted EBS immediately as EC2 uses plain data-key in memory to manage I/O. The EBS cannot be reused as next mount option will fail. Grants - very specific, easy to create/revoke. Useful to provide temporary or granular permissions on CMKs.\n$ aws kms create-grant \\ --key-id 1234abcd-12ab-34cd-56ef-1234567890ab \\ --grantee-principal arn:aws:iam::111122223333:user/exampleUser \\ --retiring-principal arn:aws:iam::111122223333:role/adminRole \\ --operations GenerateDataKey \\ --constraints EncryptionContextEquals={Purpose=Test} Key Policies - This policy delegates all access to IAM, root does not necessarily represent the root user here. Refer\n{ \"Sid\": \"Enable IAM User Permissions\", \"Effect\": \"Allow\", \"Principal\": {\"AWS\": \"arn:aws:iam::111122223333:root\"}, \"Action\": \"kms:*\", \"Resource\": \"*\" } Envelope Encryption\nEncrypting plaintext data with a data key, and then encrypting the data key under another key. Protects keys - safe to store the encrypted data key alongside the encrypted data. Encrypting the same data under multiple master keys - instead of re-encrypting raw data multiple times with different keys, re-encrypt only the data keys that protect the raw data. Combining the strengths of multiple algorithms. Encryption Context\n(Optional) Key–value pairs containing additional contextual information (AAD) about the data. Same encryption context is required to decrypt (or decrypt and re-encrypt) the data as provided while encypting it. Not secret, appears in plaintext in CloudTrail. Do not use for sensitive data. Use to limit access to CMKs. Use as a constraint in grants and as a condition in policy statements. Example - encrypted EBS snapshots use volume-id as encryption context. CloudHSM Securely generate, store, and manage cryptographic keys used for data encryption. Keys are accessible only by you (owner). Each HSM appears as a network resource in VPC. Can only be provisioned within a VPC. No free tier. No reserved instance pricing. Physical and digital tamper detection. IAM Always pick temporary credential option like IAM Role over long term access like Access Key/Secret Key. Least Permission model - never assign more than the bare minimum required permissions. MFA on root - must. AWS Org SCP policy can deny actions to member account root users. Policy evaluation flow = deny all \u003e org scp \u003e resource based policy \u003e iam permission boundary \u003e session policy \u003e identity based policy. Confused Deputy - always use an externalId when allowing third party to assume IAM role in your account. S3 Bucket ACL\nGrant basic read/write permissions to other AWS accounts. Limited permissions available. Cannot grant permissions to users in same account. Cannot grant conditional permissions. Cannot explicitly deny permissions. Object ACL\nBucket Policy\nIAM Policy\nSSE-S3\nS3 manages the data and master encryption keys. SSE-C\nCustomer manages the encryption key. SSE-KMS\nAWS manages the data key but customer manages the master key (CMK) in AWS KMS.\nThe AWS KMS CMK must be in the same Region as the bucket.\nAll GET and PUT requests for an object protected by AWS KMS fail if they are not made via SSL or TLS, or without SigV4.\nBucket Keys\nUsed to create unique data keys for objects. Used for a time-limited period within Amazon S3, reducing the need to make requests to KMS to complete encryption operations. Reduces the cost of KMS operations. S3 uses the bucket ARN as the encryption context instead of the object ARN if using bucket keys. Replication\nIf source object uses S3 Bucket Keys \u0026 destination bucket uses default encryption, replica object maintains its S3 Bucket Key encryption settings in the destination bucket. If source object is not encrypted \u0026 destination bucket uses S3 Bucket Key with SSE-KMS, replica object is encrypted with an S3 Bucket Key using SSE-KMS. This results in the ETag of the source object being different from the ETag of the replica object. ACM Public/private SSL/TLS certs for AWS services and other internal connected resources. Auto renewals for ACM issued certs. Not for imported 3rd party certs. Cannot issue or renew certificates using DNS validation if CNAME record is removed. Contact support to revoke a public issued cert via ACM. ACM issued certs cannot be copied between regions. ACM does not have an SLA. Public ACM certificates can be used only with specific AWS services. To use an ACM certificate with Amazon CloudFront, request the certificate in the US East (N. Virginia). Private Certs Secure communication between connected resources on private networks. Private CA renews the cert, but user needs to retrieve and depoy to the private resources. Steps - Install OpenSSL \u0026 Generate private key. Generate CSR with the new key. Call ACM issue-certificate with CSR. Call ACM get-certificate to get the issued private cert. Required IAM Permissions - acm-pca:GetCertificate and acm:IssueCertificate. AWS Web Application Firewall (WAF) Configure rules to allow, block, or monitor (count) web requests based on defined conditions - IP addresses, HTTP headers, HTTP body, URI strings, SQL injection and cross-site scripting. Runs on edge if applied to CloudFront. Runs in region if applied to API GW, ALB, AppSync etc. Rate-based rule - allow spefic number of hits for particular condition (IP, Path, Headers or a combination). Mitigate DDoS. Configure a “count” action for rules, which counts the number of web requests that meet rule conditions. Managed rules - OWASP, bots, or CVEs. Amazon Macie Detects sensitive data like including personally identifiable information (PII) such as names, addresses, and credit card numbers. Supports custom-defined data types using regular expressions. Constant visibility of the data security and data privacy of data stored in Amazon S3. Regional service - needs to be enabled per region. Can also be enabled from AWS Org for multiple accounts. AWS Trusted Advisor Automated weekly checks for business/enterprise support accounts and email notifications. Basic support - S3 Bucket Permissions, Security Groups - Specific Ports Unrestricted, IAM Use, MFA on Root Account, EBS Public Snapshots, RDS Public Snapshots. Other supports - full access. Does not monitor continuously - periodic refreshes. AWS CloudTrail GUI - Last 90 days’ events (management events) for current region.\nFor \u003e90 days visibility configure a CloudTrail trail.\nA CloudTrail trail can deliver CloudTrail events to Amazon S3, Amazon CloudWatch Logs, and Amazon CloudWatch Events.\nData Events, Management Events, Read-Only Events.\nTrail for all regions will capture any newly created regions as well.\n5 Trails/region.\nCaptures auto/manual trusted advisor check refreshes.\nUnsuccessful sign-in events by the root user are not logged by CloudTrail.\nDoes not log HSM device or access logs. These are available in CloudWatch Logs.\nAWS does not log the entered IAM user name text when the sign-in failure is caused by an incorrect user name. The user name text is masked by the value HIDDEN_DUE_TO_SECURITY_REASONS.\nHas a history of all AWS WAF API calls made on account.\nDeliver logs to S3\nEncrypted with SSE-S3 by default. Can be configured to use SSE-KMS too. CloudTrail must have the required permissions on bucket. Attach a policy for using existing bucket. It cannot be a Requester Pays bucket. CloudTrail automatically attaches the required permissions to a new bucket when creating or updating a trail from console. Older bucket policy using CloudTrail account IDs for each region (New use service principle cloudtrail.amazonaws.com) can cause log delivery issues. A bucket policy with an incorrect prefix can prevent cloudtrail from delivering logs. AWS Config Fully managed service that provides AWS resource inventory, configuration history, and configuration change notifications to enable security and governance.\nConfig rules\nDesired config for a resource. Evaluated against config changes on relevant resources, as recorded by AWS Config. AWS managed or Customer managed. 150 rule limit - can submit an extension request. Change-triggered rule (based on tag, resource type or resource id) or a periodic rule (1,3,6,12,24 hrs). Try to update the rule (\u0026 lambda) instead of deleting it and creating a new rule. New rule result in charges. Conformance pack\nCollection of Config rules and remediation actions. A framework to build and deploy compliance packages. Deploy at scale across accounts. Resource configuration history\nRelate config changes with AWS CloudTrail events that made the change. Useful to get info like “Who made the change?”, “From what IP address?” AWS Security Hub vs AWS Config conformance packs - If compliance is already present in AWS Security Hub, then it is the easiest way to operationalize it. Go with Config conformance pack if need is to have something custom.\nAggregate AWS Config data from multiple accounts and regions into a single account and a single region. However it cannot be used for provisioning rules across multiple accounts. It is purely a reporting capability.\nAlso record configuration changes to Operating System updates, network configuration, installed applications, etc within EC2 instances, virtual machines (VMs), or on-prem servers.\nAWS Config sends notifications only when the compliance status changes. If a resource was previously non-compliant and is still non-compliant, Config will not send a new notification. If the compliance status changes to “compliant”, you will receive a notification for the change in status.\nDoes not evaluate rules prior to provisioning a resource or prior to making configuration changes on the resource.\nDoes not guarantee that resources will be compliant or prevent users from taking non-compliant actions. Can make them compliant after the change though via remediation actions.\nCan connect to ServiceNow and Jira Service Desk instances to AWS Config using AWS Service Management Connector.\nAmazon Inspector Automated security assessment service that can test the network accessibility of EC2 instances and the security state of applications running on the EC2. Agent needed on EC2 for Host assessment. Rules packages include Common Vulnerabilities and Exposures (CVE), Center for Internet Security (CIS) Operating System configuration benchmarks, and security best practices. No agent necessary for the network reachability rules package that checks for network accessibility of EC2. Only the pre-defined rules are currently allowed for assessment runs. No custom rules possible. Generates a findings report (exec summary) or a full report (complete details) after assessment run. Periodic - Set up custom schedules with either a fixed recurring rate or a more detailed Cron expression through CloudWatch Events. Event based - Use Amazon CloudWatch Events to create event patterns which monitor other AWS services for actions to trigger an assessment. Cloudwatch EC2 instance agent to send application logs to cloudwatch. Errors Log rotation method not supported. No internet connectivity to cloudwatch API. Fingerprinting - log-identifying hash. Permission - no access via role, no role etc. Timestamp - events do not begin with timestamp, log path incorrect, cannot push from multiple logs to a single log stream. AWS GuardDuty Analyzes continuous streams of meta-data generated and network activity in AWS CloudTrail, Amazon VPC Flow Logs, and DNS Logs. Threat intelligence such as known malicious IP addresses, anomaly detection etc. Identify threats such as attacker reconnaissance, instance compromise, account compromise, and bucket compromise. GuardDuty security findings remain in the same region where the underlying data was generated. Aggregation - self managed via CloudWatch Events, S3 etc. Multiple account feature - All security findings are aggregated to master account for review and remediation. CloudWatch Events are also aggregated to master account in this case. GuardDuty cannot access and process data from a 3rd party DNS resolver (non Route53). VPC Security Groups\nStateful - need only inbound rule, outbound is allowed if inbound is allowed. Use if need to allow an IP. Network Access Control Lists (NACL)\nStateless - need both inbound/outbound rule to allow traffic Use if need to block an IP Flow Logs\nAbstracted data - do not allow for full package reconstruction Capture source/destination IP, ports, protocol, start/end time, no of packets, no of bytes, action etc. EC2 Disable source/destination check attribute for instances running services such as network address translation, routing, or a firewall. Enabled by default. IPtables can be used to restrict access to ec2 metadata service. Prefer access rules over deny rules. Launch the instance with --metadata-options set to HttpEndpoint=disabled to disable metadata service. Packet capture - Marketplace AMI, route all traffic though it. AWS does not support virtual instances running in promiscuous mode. Select ciphers to use for SSL connections by creating a custom ELB security policy (cannot edit default). AD Authentication Reference DynamoDB Encryption Server-side encryption\nBy default - encrypts all tables, cannot be disabled. Uses AWS owned CMK. Encrypts all table and related data incl primary keys, local/secondary indexes, backups, global tables etc. DynamoDB Encryption Client\nDoes not encrypt entire items. primary keys, attributes are still in plain text. Customer managed CMK (incl custom crypographic data from cloudHSM). Use with Java/Python. Others AWS Artifact - audit artifact retrieval portal that provides AWS’ compliance documentation and AWS agreements. REFERENCES AWS Security Best Practices AD Authentication FLow Security related trainings ","wordCount":"2756","inLanguage":"en","datePublished":"2024-02-15T00:00:00Z","dateModified":"2024-03-05T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://abiydv.github.io/notes/aws/security-services/"},"publisher":{"@type":"Organization","name":"@abiydv","logo":{"@type":"ImageObject","url":"https://abiydv.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://abiydv.github.io/ accesskey=h title="@abiydv (Alt + H)">@abiydv</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://abiydv.github.io/ title=Home><span>Home</span></a></li><li><a href=https://abiydv.github.io/about/ title=About><span>About</span></a></li><li><a href=https://abiydv.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://abiydv.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://abiydv.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://abiydv.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://abiydv.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://abiydv.github.io/notes/>Notes</a>&nbsp;»&nbsp;<a href=https://abiydv.github.io/notes/aws/>AWS</a></div><h1 class=post-title>AWS Security Services<sup>&nbsp;<span class="entry-stage sandbox">&nbsp;sandbox&nbsp;</span></sup></h1><div class=post-meta><s>15.2.24</s>&nbsp;5.3.24 / Notes / 13 min</div></header><div class=post-content><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#security-hub aria-label="Security Hub">Security Hub</a></li><li><a href=#aws-inspector aria-label="AWS Inspector">AWS Inspector</a></li><li><a href=#macie aria-label=Macie>Macie</a><ul><li><a href=#kms aria-label=KMS>KMS</a></li><li><a href=#cloudhsm aria-label=CloudHSM>CloudHSM</a></li><li><a href=#iam aria-label=IAM>IAM</a></li><li><a href=#s3 aria-label=S3>S3</a></li><li><a href=#acm aria-label=ACM>ACM</a></li><li><a href=#aws-web-application-firewall-waf aria-label="AWS Web Application Firewall (WAF)">AWS Web Application Firewall (WAF)</a></li><li><a href=#amazon-macie aria-label="Amazon Macie">Amazon Macie</a></li><li><a href=#aws-trusted-advisor aria-label="AWS Trusted Advisor">AWS Trusted Advisor</a></li><li><a href=#aws-cloudtrail aria-label="AWS CloudTrail">AWS CloudTrail</a></li><li><a href=#aws-config aria-label="AWS Config">AWS Config</a></li><li><a href=#amazon-inspector aria-label="Amazon Inspector">Amazon Inspector</a></li><li><a href=#cloudwatch aria-label=Cloudwatch>Cloudwatch</a></li><li><a href=#aws-guardduty aria-label="AWS GuardDuty">AWS GuardDuty</a></li><li><a href=#vpc aria-label=VPC>VPC</a></li><li><a href=#ec2 aria-label=EC2>EC2</a></li><li><a href=#ad-authentication aria-label="AD Authentication">AD Authentication</a></li><li><a href=#dynamodb-encryption aria-label="DynamoDB Encryption">DynamoDB Encryption</a></li><li><a href=#others aria-label=Others>Others</a></li><li><a href=#references aria-label=REFERENCES>REFERENCES</a></li></ul></li></ul></div></details></div></div><div class=post-content><h1 id=security-hub>Security Hub<a hidden class=anchor aria-hidden=true href=#security-hub>#</a></h1><p>Add details</p><h1 id=aws-inspector>AWS Inspector<a hidden class=anchor aria-hidden=true href=#aws-inspector>#</a></h1><p>automated vulnerability management service that continually scans <a href=/notes/aws/ec2/>Amazon Elastic Compute Cloud (EC2)</a></p><p><a href=/notes/aws/lambda/>AWS Lambda functions</a>, and container images in Amazon ECR and within continuous integration and continuous delivery (CI/CD) tools, in <em>near-real time</em> for software <em>vulnerabilities and unintended network exposure</em>.</p><p>Common Vulnerability Scoring System (CVSS) v2 and v3 scores from both National Vulnerability Database (NVD) and vendors</p><p>manage software bill of materials (SBOM) exports for all monitored resources.</p><p>integrates with <a href=/notes/aws/security-services/#security-hub>Security Hub</a>, <a href=/notes/aws/eventbridge/>AWS EventBridge</a> to automate workflows and ticket routing</p><p>integrates with <a href=/notes/aws/organizations/>AWS Organizations</a> for central management</p><p>integrates with <a href=/notes/aws/systems-manager/>SSM</a>, and uses the same agent for it&rsquo;s findings</p><h1 id=macie>Macie<a hidden class=anchor aria-hidden=true href=#macie>#</a></h1><p>discovers sensitive data using machine learning and pattern matching, provides visibility into data security risks, and enables automated protection</p><p>enabled on a per-region basis</p><p>managed data identifier = built-in criteria and techniques that are designed to detect a specific type of sensitive data</p><p>custom data identifier = define custom data patterns using regex for your unique usecase, for example, a particular format of employee email addresses or ids. You can also specify character sequences, such as words and phrases, and a proximity rule to refine the results.</p><p>integrates with <a href=/notes/aws/security-services/#security-hub>Security Hub</a>, <a href=/notes/aws/eventbridge/>AWS EventBridge</a></p><p>integrates with <a href=/notes/aws/organizations/>AWS Organizations</a> to discover sensitive data across all accounts</p><h2 id=kms>KMS<a hidden class=anchor aria-hidden=true href=#kms>#</a></h2><ul><li><p>Highly available key generation, storage, management, and auditing solution to encrypt or digitally sign data within applications or control the encryption of data across AWS services.</p></li><li><p><code>Enable Private DNS Name</code> makes the standard AWS KMS DNS hostname (<a href=https://kms.region.amazonaws.com>https://kms.region.amazonaws.com</a>) resolve to VPC endpoint.</p></li><li><p>Supports <strong>Symmetric</strong> (256-bit key that is used for encryption and decryption) and <strong>Asymmetric</strong> CMKs (an RSA key pair that is used for encryption and decryption or signing and verification but not both, or an elliptic curve (ECC) key pair that is used for signing and verification).</p></li><li><p><strong>Asymmetric</strong> customer managed CMKs - the key material can only be generated within AWS KMS HSMs and no option for automatic key rotation.</p></li><li><p><strong>Symmetric</strong> CMKs and the private keys of <strong>Asymmetric</strong> CMKs never leave AWS KMS unencrypted and AWS KMS does not store, manage, or track data keys.</p></li><li><p><strong>Cryptographic Operations</strong></p><ul><li><code>Decrypt</code>, <code>Encrypt</code>, <code>GenerateDataKey</code>, <code>GenerateDataKeyPair</code>, <code>GenerateDataKeyPairWithoutPlaintext</code>, <code>GenerateDataKeyWithoutPlaintext</code>, <code>GenerateRandom</code>, <code>ReEncrypt</code>, <code>Sign</code>, <code>Verify</code></li><li><code>GenerateRandom</code> does not use any CMK.</li></ul></li><li><p><strong>Customer Master Key (CMK)</strong></p><ul><li>Logical representation of a master key.</li><li>Includes metadata, such as the key ID, creation date, description, and key state.</li><li>Contains the key material used to encrypt and decrypt data. Cannot be changed.</li><li>Alias - friendly name. Can be used in KMS operations (including cryptographic). Use single alias to refer to different CMKs in different Region. Can add, change, and delete an alias without affecting the associated CMK.</li></ul></li><li><p><strong>AWS Managed CMK</strong></p><ul><li>Partial control. Track in account, choose which ones to use, track usage via Cloudtrail.</li><li>Mandatory rotation in 1095 days/3 yrs.</li><li>No monthly fee.</li><li>Do not count against resource quotas on the number of CMKs in each Region.</li><li><code>DescribeKey</code> API response, the <code>KeyManager</code> value is <code>AWS</code>.</li><li>Cannot edit the key policy.</li></ul></li><li><p><strong>Customer Managed CMK</strong></p><ul><li>Full control. Define access control and usage policy for each key, grant permissions to other accounts and services.</li><li>Key material can be generated in KMS, CloudHSM or be from outside AWS.</li><li>Optional rotation 365 days/1 yr.</li><li>Incur a monthly fee and a fee for use in excess of the free tier.</li><li>Counted against quota for number of CMKs in each Region.</li><li><code>DescribeKey</code> API response, the <code>KeyManager</code> value is <code>Customer</code>.</li><li>Use key policy to add, remove, or change permissions at any time.</li></ul></li><li><p><strong>AWS owned CMK</strong></p><ul><li>CMKs that an AWS service owns and manages for use in multiple AWS accounts.</li><li>Not in your AWS account but AWS service can use it to protect the resources in account.</li></ul></li><li><p><strong>Key Rotation</strong></p><ul><li>Manual only - asymmetric, CMK with imported key material, CMKs in custom key stores (ex- using CloudHSM).</li><li>Automatic - yearly for customer managed CMK (disabled by default).</li></ul></li><li><p><strong>Key Deletion</strong></p><ul><li>Schedule key deletion - 7 days (min) to 30 days (max, default).</li><li>Key scheduled for deletion cannot be used for cryptographic operations.</li><li>CMK with imported key material - can delete the key material immediately. CMK can be re-enabled by reimporting the key material.</li><li>Deleted CMK may not impact mounted encrypted EBS immediately as EC2 uses plain data-key in memory to manage I/O. The EBS cannot be reused as next mount option will fail.</li></ul></li><li><p><strong>Grants</strong> - very specific, easy to create/revoke. Useful to provide temporary or granular permissions on CMKs.</p><pre tabindex=0><code>$ aws kms create-grant \
    --key-id 1234abcd-12ab-34cd-56ef-1234567890ab \
    --grantee-principal arn:aws:iam::111122223333:user/exampleUser \
    --retiring-principal arn:aws:iam::111122223333:role/adminRole \
    --operations GenerateDataKey \
    --constraints EncryptionContextEquals={Purpose=Test}
</code></pre></li><li><p><strong>Key Policies</strong> - This policy <em>delegates</em> all access to IAM, <code>root</code> does not necessarily represent the <code>root</code> user here. <a href=https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html#key-policy-default>Refer</a></p><pre tabindex=0><code>{
  &#34;Sid&#34;: &#34;Enable IAM User Permissions&#34;,
  &#34;Effect&#34;: &#34;Allow&#34;,
  &#34;Principal&#34;: {&#34;AWS&#34;: &#34;arn:aws:iam::111122223333:root&#34;},
  &#34;Action&#34;: &#34;kms:*&#34;,
  &#34;Resource&#34;: &#34;*&#34;
}
</code></pre></li><li><p><strong>Envelope Encryption</strong></p><ul><li>Encrypting plaintext data with a data key, and then encrypting the data key under another key.</li><li>Protects keys - safe to store the encrypted data key alongside the encrypted data.</li><li>Encrypting the same data under multiple master keys - instead of re-encrypting raw data multiple times with different keys, re-encrypt only the data keys that protect the raw data.</li><li>Combining the strengths of multiple algorithms.</li></ul></li><li><p><strong>Encryption Context</strong></p><ul><li>(Optional) Key–value pairs containing additional contextual information (AAD) about the data.</li><li>Same encryption context is required to decrypt (or decrypt and re-encrypt) the data as provided while encypting it.</li><li>Not secret, appears in plaintext in CloudTrail.</li><li>Do not use for sensitive data.</li><li>Use to limit access to CMKs. Use as a constraint in grants and as a condition in policy statements.</li><li>Example - encrypted EBS snapshots use volume-id as encryption context.</li></ul></li></ul><h2 id=cloudhsm>CloudHSM<a hidden class=anchor aria-hidden=true href=#cloudhsm>#</a></h2><ul><li>Securely generate, store, and manage cryptographic keys used for data encryption.</li><li>Keys are accessible only by you (owner).</li><li>Each HSM appears as a network resource in VPC. Can <strong>only</strong> be provisioned within a VPC.</li><li>No free tier.</li><li>No reserved instance pricing.</li><li>Physical and digital tamper detection.</li></ul><h2 id=iam>IAM<a hidden class=anchor aria-hidden=true href=#iam>#</a></h2><ul><li>Always pick temporary credential option like IAM Role over long term access like Access Key/Secret Key.</li><li>Least Permission model - never assign more than the bare minimum required permissions.</li><li>MFA on root - must.</li><li>AWS Org SCP policy can deny actions to member account root users.</li><li>Policy evaluation flow = deny all > org scp > resource based policy > iam permission boundary > session policy > identity based policy.</li><li><a href=https://aws.amazon.com/blogs/security/how-to-use-external-id-when-granting-access-to-your-aws-resources/>Confused Deputy</a> - always use an externalId when allowing third party to assume IAM role in your account.</li></ul><h2 id=s3>S3<a hidden class=anchor aria-hidden=true href=#s3>#</a></h2><ul><li><p><strong>Bucket ACL</strong></p><ul><li>Grant basic read/write permissions to other AWS accounts. Limited permissions available.</li><li>Cannot grant permissions to users in same account.</li><li>Cannot grant conditional permissions.</li><li>Cannot explicitly deny permissions.</li></ul></li><li><p><strong>Object ACL</strong></p></li><li><p><strong>Bucket Policy</strong></p></li><li><p><strong>IAM Policy</strong></p></li><li><p><strong>SSE-S3</strong></p><ul><li>S3 manages the data and master encryption keys.</li></ul></li><li><p><strong>SSE-C</strong></p><ul><li>Customer manages the encryption key.</li></ul></li><li><p><strong>SSE-KMS</strong></p><ul><li><p>AWS manages the data key but customer manages the master key (CMK) in AWS KMS.</p></li><li><p>The AWS KMS CMK must be in the same Region as the bucket.</p></li><li><p>All GET and PUT requests for an object protected by AWS KMS fail if they are not made via SSL or TLS, or without SigV4.</p></li><li><p><strong>Bucket Keys</strong></p><ul><li>Used to create unique data keys for objects.</li><li>Used for a time-limited period within Amazon S3, reducing the need to make requests to KMS to complete encryption operations.</li><li>Reduces the cost of KMS operations.</li><li>S3 uses the bucket ARN as the encryption context instead of the object ARN if using bucket keys.</li></ul></li><li><p><strong>Replication</strong></p><ul><li>If source object uses S3 Bucket Keys & destination bucket uses default encryption, replica object maintains its S3 Bucket Key encryption settings in the destination bucket.</li><li>If source object is not encrypted & destination bucket uses S3 Bucket Key with SSE-KMS, replica object is encrypted with an S3 Bucket Key using SSE-KMS. This results in the ETag of the source object being different from the ETag of the replica object.</li></ul></li></ul></li></ul><h2 id=acm>ACM<a hidden class=anchor aria-hidden=true href=#acm>#</a></h2><ul><li>Public/private SSL/TLS certs for AWS services <strong>and</strong> other internal connected resources. Auto renewals for ACM issued certs.</li><li>Not for imported 3rd party certs.</li><li>Cannot issue or renew certificates using DNS validation if CNAME record is removed.</li><li>Contact support to revoke a public issued cert via ACM.</li><li>ACM issued certs cannot be copied between regions.</li><li>ACM does not have an SLA.</li><li>Public ACM certificates can be used only with specific AWS services.</li><li>To use an ACM certificate with Amazon CloudFront, request the certificate in the US East (N. Virginia).</li><li><strong>Private Certs</strong><ul><li>Secure communication between connected resources on private networks.</li><li>Private CA renews the cert, but user needs to retrieve and depoy to the private resources.</li><li>Steps -<ul><li>Install OpenSSL & Generate private key.</li><li>Generate CSR with the new key.</li><li>Call ACM <code>issue-certificate</code> with CSR.</li><li>Call ACM <code>get-certificate</code> to get the issued private cert.</li><li>Required IAM Permissions - <code>acm-pca:GetCertificate</code> and <code>acm:IssueCertificate</code>.</li></ul></li></ul></li></ul><h2 id=aws-web-application-firewall-waf>AWS Web Application Firewall (WAF)<a hidden class=anchor aria-hidden=true href=#aws-web-application-firewall-waf>#</a></h2><ul><li>Configure rules to allow, block, or monitor (count) web requests based on defined conditions - IP addresses, HTTP headers, HTTP body, URI strings, SQL injection and cross-site scripting.</li><li>Runs on edge if applied to CloudFront.</li><li>Runs in region if applied to API GW, ALB, AppSync etc.</li><li>Rate-based rule - allow spefic number of hits for particular condition (IP, Path, Headers or a combination). Mitigate DDoS.</li><li>Configure a “count” action for rules, which counts the number of web requests that meet rule conditions.</li><li>Managed rules - OWASP, bots, or CVEs.</li></ul><h2 id=amazon-macie>Amazon Macie<a hidden class=anchor aria-hidden=true href=#amazon-macie>#</a></h2><ul><li>Detects sensitive data like including personally identifiable information (PII) such as names, addresses, and credit card numbers.</li><li>Supports custom-defined data types using regular expressions.</li><li>Constant visibility of the data security and data privacy of data stored in Amazon S3.</li><li>Regional service - needs to be enabled per region.</li><li>Can also be enabled from AWS Org for multiple accounts.</li></ul><h2 id=aws-trusted-advisor>AWS Trusted Advisor<a hidden class=anchor aria-hidden=true href=#aws-trusted-advisor>#</a></h2><ul><li>Automated weekly checks for business/enterprise support accounts and email notifications.</li><li>Basic support - S3 Bucket Permissions, Security Groups - Specific Ports Unrestricted, IAM Use, MFA on Root Account, EBS Public Snapshots, RDS Public Snapshots. Other supports - full access.</li><li>Does not monitor continuously - periodic refreshes.</li></ul><h2 id=aws-cloudtrail>AWS CloudTrail<a hidden class=anchor aria-hidden=true href=#aws-cloudtrail>#</a></h2><ul><li><p>GUI - Last 90 days&rsquo; events (management events) for current region.</p></li><li><p>For >90 days visibility configure a CloudTrail trail.</p></li><li><p>A CloudTrail trail can deliver CloudTrail events to Amazon S3, Amazon CloudWatch Logs, and Amazon CloudWatch Events.</p></li><li><p>Data Events, Management Events, Read-Only Events.</p></li><li><p>Trail for all regions will capture any newly created regions as well.</p></li><li><p>5 Trails/region.</p></li><li><p>Captures auto/manual trusted advisor check refreshes.</p></li><li><p>Unsuccessful sign-in events by the root user are not logged by CloudTrail.</p></li><li><p>Does not log HSM device or access logs. These are available in CloudWatch Logs.</p></li><li><p>AWS does not log the entered IAM user name text when the sign-in failure is caused by an incorrect user name. The user name text is masked by the value <code>HIDDEN_DUE_TO_SECURITY_REASONS</code>.</p></li><li><p>Has a history of all AWS WAF API calls made on account.</p></li><li><p><strong>Deliver logs to S3</strong></p><ul><li>Encrypted with SSE-S3 by default. Can be configured to use SSE-KMS too.</li><li>CloudTrail must have the required permissions on bucket. Attach a policy for using existing bucket.</li><li>It cannot be a Requester Pays bucket.</li><li>CloudTrail automatically attaches the required permissions to a <em>new</em> bucket when creating or updating a trail from console.</li><li>Older bucket policy using CloudTrail account IDs for each region (New use service principle <code>cloudtrail.amazonaws.com</code>) can cause log delivery issues.</li><li>A bucket policy with an incorrect prefix can prevent cloudtrail from delivering logs.</li></ul></li></ul><h2 id=aws-config>AWS Config<a hidden class=anchor aria-hidden=true href=#aws-config>#</a></h2><ul><li><p>Fully managed service that provides AWS resource inventory, configuration history, and configuration change notifications to enable security and governance.</p></li><li><p><strong>Config rules</strong></p><ul><li>Desired config for a resource. Evaluated against config changes on relevant resources, as recorded by AWS Config.</li><li><a href=https://docs.aws.amazon.com/config/latest/developerguide/managed-rules-by-aws-config.html>AWS managed</a> or Customer managed.</li><li>150 rule limit - can submit an extension request.</li><li>Change-triggered rule (based on tag, resource type or resource id) or a periodic rule (1,3,6,12,24 hrs).</li><li>Try to update the rule (& lambda) instead of deleting it and creating a new rule. New rule result in charges.</li></ul></li><li><p><strong>Conformance pack</strong></p><ul><li>Collection of Config rules and remediation actions.</li><li>A framework to build and deploy compliance packages.</li><li>Deploy at scale across accounts.</li></ul></li><li><p><strong>Resource configuration history</strong></p><ul><li>Relate config changes with AWS CloudTrail events that made the change.</li><li>Useful to get info like “Who made the change?”, “From what IP address?”</li></ul></li><li><p><strong>AWS Security Hub vs AWS Config conformance packs</strong> - If compliance is already present in AWS Security Hub, then it is the easiest way to operationalize it. Go with Config conformance pack if need is to have something custom.</p></li><li><p>Aggregate AWS Config data from multiple accounts and regions into a single account and a single region. However it cannot be used for provisioning rules across multiple accounts. It is purely a reporting capability.</p></li><li><p>Also record configuration changes to Operating System updates, network configuration, installed applications, etc within EC2 instances, virtual machines (VMs), or on-prem servers.</p></li><li><p>AWS Config sends notifications only when the compliance status changes. If a resource was previously non-compliant and is still non-compliant, Config will not send a new notification. If the compliance status changes to “compliant”, you will receive a notification for the change in status.</p></li><li><p>Does not evaluate rules prior to provisioning a resource or prior to making configuration changes on the resource.</p></li><li><p>Does not guarantee that resources will be compliant or prevent users from taking non-compliant actions. Can make them compliant after the change though via remediation actions.</p></li><li><p>Can connect to ServiceNow and Jira Service Desk instances to AWS Config using AWS Service Management Connector.</p></li></ul><h2 id=amazon-inspector>Amazon Inspector<a hidden class=anchor aria-hidden=true href=#amazon-inspector>#</a></h2><ul><li>Automated security assessment service that can test the network accessibility of EC2 instances and the security state of applications running on the EC2.</li><li>Agent needed on EC2 for Host assessment. Rules packages include Common Vulnerabilities and Exposures (CVE), Center for Internet Security (CIS) Operating System configuration benchmarks, and security best practices.</li><li>No agent necessary for the network reachability rules package that checks for network accessibility of EC2.</li><li>Only the pre-defined rules are currently allowed for assessment runs. No custom rules possible.</li><li>Generates a findings report (exec summary) or a full report (complete details) after assessment run.</li><li><strong>Periodic</strong> - Set up custom schedules with either a fixed recurring rate or a more detailed Cron expression through CloudWatch Events.</li><li><strong>Event based</strong> - Use Amazon CloudWatch Events to create event patterns which monitor other AWS services for actions to trigger an assessment.</li></ul><h2 id=cloudwatch>Cloudwatch<a hidden class=anchor aria-hidden=true href=#cloudwatch>#</a></h2><ul><li>EC2 instance agent to send application logs to cloudwatch.</li><li>Errors<ul><li>Log rotation method not supported.</li><li>No internet connectivity to cloudwatch API.</li><li>Fingerprinting - log-identifying hash.</li><li>Permission - no access via role, no role etc.</li><li>Timestamp - events do not begin with timestamp, log path incorrect, cannot push from multiple logs to a single log stream.</li></ul></li></ul><h2 id=aws-guardduty>AWS GuardDuty<a hidden class=anchor aria-hidden=true href=#aws-guardduty>#</a></h2><ul><li>Analyzes continuous streams of meta-data generated and <strong>network activity</strong> in AWS <strong>CloudTrail</strong>, Amazon <strong>VPC Flow Logs</strong>, and <strong>DNS Logs</strong>.</li><li>Threat intelligence such as known malicious IP addresses, anomaly detection etc.</li><li>Identify threats such as attacker reconnaissance, instance compromise, account compromise, and bucket compromise.</li><li>GuardDuty security findings remain in the same region where the underlying data was generated.</li><li>Aggregation - self managed via CloudWatch Events, S3 etc.</li><li>Multiple account feature - All security findings are aggregated to master account for review and remediation. CloudWatch Events are also aggregated to master account in this case.</li><li>GuardDuty cannot access and process data from a 3rd party DNS resolver (non Route53).</li></ul><h2 id=vpc>VPC<a hidden class=anchor aria-hidden=true href=#vpc>#</a></h2><ul><li><p><strong>Security Groups</strong></p><ul><li>Stateful - need only inbound rule, outbound is allowed if inbound is allowed.</li><li>Use if need to <strong>allow</strong> an IP.</li></ul></li><li><p><strong>Network Access Control Lists (NACL)</strong></p><ul><li>Stateless - need both inbound/outbound rule to allow traffic</li><li>Use if need to <strong>block</strong> an IP</li></ul></li><li><p><strong>Flow Logs</strong></p><ul><li>Abstracted data - do not allow for full package reconstruction</li><li>Capture source/destination IP, ports, protocol, start/end time, no of packets, no of bytes, action etc.</li></ul></li></ul><h2 id=ec2>EC2<a hidden class=anchor aria-hidden=true href=#ec2>#</a></h2><ul><li><strong>Disable</strong> source/destination check attribute for instances running services such as network address translation, routing, or a firewall. Enabled by default.</li><li>IPtables can be used to restrict access to ec2 metadata service. Prefer access rules over deny rules.</li><li>Launch the instance with <code>--metadata-options</code> set to <code>HttpEndpoint=disabled</code> to disable metadata service.</li><li>Packet capture - Marketplace AMI, route all traffic though it.</li><li>AWS does not support virtual instances running in promiscuous mode.</li><li>Select ciphers to use for SSL connections by creating a custom ELB security policy (cannot edit default).</li></ul><h2 id=ad-authentication>AD Authentication<a hidden class=anchor aria-hidden=true href=#ad-authentication>#</a></h2><ul><li><a href=https://aws.amazon.com/blogs/security/aws-federated-authentication-with-active-directory-federation-services-ad-fs/>Reference</a></li></ul><h2 id=dynamodb-encryption>DynamoDB Encryption<a hidden class=anchor aria-hidden=true href=#dynamodb-encryption>#</a></h2><ul><li><p><strong>Server-side encryption</strong></p><ul><li>By default - encrypts all tables, cannot be disabled.</li><li>Uses AWS owned CMK.</li><li>Encrypts all table and related data incl primary keys, local/secondary indexes, backups, global tables etc.</li></ul></li><li><p><strong>DynamoDB Encryption Client</strong></p><ul><li>Does not encrypt entire items. primary keys, attributes are still in plain text.</li><li>Customer managed CMK (incl custom crypographic data from cloudHSM).</li><li>Use with Java/Python.</li></ul></li></ul><h2 id=others>Others<a hidden class=anchor aria-hidden=true href=#others>#</a></h2><ul><li>AWS Artifact - audit artifact retrieval portal that provides AWS’ compliance documentation and AWS agreements.</li></ul><h2 id=references>REFERENCES<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://d1.awsstatic.com/whitepapers/Security/AWS_Security_Best_Practices.pdf>AWS Security Best Practices</a></li><li><a href=https://aws.amazon.com/blogs/security/aws-federated-authentication-with-active-directory-federation-services-ad-fs/>AD Authentication FLow</a></li><li><a href="https://www.aws.training/LearningLibrary?filters=language%3A1&filters=classification%3A27&filters=digital%3A1&tab=digital_courses">Security related trainings</a></li></ul></div><footer class=post-footer><hr><div class=align-center><div class=slimlist-entry><h2>Topics</h2></div><ul class=post-tags><div class=slimlist-entry><li class=post-tags><a href=https://abiydv.github.io/topics/aws/>aws</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/stage-sandbox/>stage/sandbox</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/security/>security</a></li></div></ul></div></footer><script src=https://utteranc.es/client.js repo=abiydv/abiydv.github.io issue-term=title label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2019-2025 <a href=https://abiydv.github.io/>@abiydv</a> / </span><span>Published 4.4.25 /
</span><span>Thanks <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>, <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>