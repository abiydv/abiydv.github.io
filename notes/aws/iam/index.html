<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AWS Identity and Access Management (IAM) | @abiydv</title>
<meta name=keywords content><meta name=description content="Access Analyzer https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/
In addition to roles, it also analyzes resource policies on supported resources
Monitors resources for external access AWS Simple Storage(S3) buckets AWS Identity and Access Management roles AWS Key Management Service Keys AWS Lambda functions and layers AWS Simple Queue Service queues AWS Secrets Manager secrets
Identity Center SSO for Org
Policy Conditions Useful to allow/deny actions based on certain conditions in addition to resource arn or patterns."><meta name=author content><link rel=canonical href=https://abiydv.github.io/notes/aws/iam/><link crossorigin=anonymous href=/assets/css/stylesheet.c5edd088d0c984c192170cfbab7d2de030010ee0b7d771bd6bca049dd2332874.css integrity="sha256-xe3QiNDJhMGSFwz7q30t4DABDuC313G9a8oEndIzKHQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://abiydv.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://abiydv.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://abiydv.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://abiydv.github.io/apple-touch-icon.png><link rel=mask-icon href=https://abiydv.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://abiydv.github.io/notes/aws/iam/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="AWS Identity and Access Management (IAM)"><meta property="og:description" content="Access Analyzer https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/
In addition to roles, it also analyzes resource policies on supported resources
Monitors resources for external access AWS Simple Storage(S3) buckets AWS Identity and Access Management roles AWS Key Management Service Keys AWS Lambda functions and layers AWS Simple Queue Service queues AWS Secrets Manager secrets
Identity Center SSO for Org
Policy Conditions Useful to allow/deny actions based on certain conditions in addition to resource arn or patterns."><meta property="og:type" content="article"><meta property="og:url" content="https://abiydv.github.io/notes/aws/iam/"><meta property="article:section" content="notes"><meta property="article:published_time" content="2024-02-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-04T12:48:24+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AWS Identity and Access Management (IAM)"><meta name=twitter:description content="Access Analyzer https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/
In addition to roles, it also analyzes resource policies on supported resources
Monitors resources for external access AWS Simple Storage(S3) buckets AWS Identity and Access Management roles AWS Key Management Service Keys AWS Lambda functions and layers AWS Simple Queue Service queues AWS Secrets Manager secrets
Identity Center SSO for Org
Policy Conditions Useful to allow/deny actions based on certain conditions in addition to resource arn or patterns."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://abiydv.github.io/notes/"},{"@type":"ListItem","position":2,"name":"AWS","item":"https://abiydv.github.io/notes/aws/"},{"@type":"ListItem","position":3,"name":"AWS Identity and Access Management (IAM)","item":"https://abiydv.github.io/notes/aws/iam/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AWS Identity and Access Management (IAM)","name":"AWS Identity and Access Management (IAM)","description":"Access Analyzer https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/\nIn addition to roles, it also analyzes resource policies on supported resources\nMonitors resources for external access AWS Simple Storage(S3) buckets AWS Identity and Access Management roles AWS Key Management Service Keys AWS Lambda functions and layers AWS Simple Queue Service queues AWS Secrets Manager secrets\nIdentity Center SSO for Org\nPolicy Conditions Useful to allow/deny actions based on certain conditions in addition to resource arn or patterns.","keywords":[],"articleBody":"Access Analyzer https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/\nIn addition to roles, it also analyzes resource policies on supported resources\nMonitors resources for external access AWS Simple Storage(S3) buckets AWS Identity and Access Management roles AWS Key Management Service Keys AWS Lambda functions and layers AWS Simple Queue Service queues AWS Secrets Manager secrets\nIdentity Center SSO for Org\nPolicy Conditions Useful to allow/deny actions based on certain conditions in addition to resource arn or patterns.\nCan be used for ABAC\nTag based access control\nUse the Service Authorization page to find which service or actions support which condition keys.\nContext keys can be single valued or multi valued, more here\nCondition Operators\nEvaluation logic - AND, OR conditions\nGlobal Keys These are available for most services and actions\nAll keys need an aws: suffix unless the prefix is specifically mentioned for a condition, liek ec2:RoleDelivery\nPrincipal Example Value Why use it? Notes PrincipalArn PrincipalAccount PrincipalOrgPaths PrincipalOrgID PrincipalTag/TagKey PrincipalIsAWSService PrincipalServiceName PrincipalServiceNamesList PrincipalType userid username Role Session Example Value Why use it? Notes FederatedProvider TokenIssueTime MultiFactorAuthPresent Ec2InstanceSourceVpc Ec2InstanceSourcePrivateIPv4 SourceIdentity ec2:RoleDelivery ec2:SourceInstanceArn glue:RoleAssumedBy glue:CredentialIssuingService lambda:SourceFunctionArn ssm:SourceInstanceArn identitystore:UserId Network Example Value Why use it? Notes SourceIp SourceVpc SourceVpce VpcSourceIp Resource Properties Example Value Why use it? Notes ResourceAccount ResourceOrgPaths ResourceOrgID ResourceTag/TagKey Request Properties Example Values Why use it? CalledVia CalledViaFirst CalledViaLast ViaAWSService CurrentTime EpochTime referer RequestedRegion us-east-1 Implement region deny controls by using this condition in an IAM policy or an SCP RequestTag/TagKey Implement standard tags. Deny action if tag not present. Not all resources support request tags (RDS doesn’t!), so needs to be applied with other controls. TagKeys SecureTransport true, false Implement encryption-in-transit by denying actions which do not have this enable. SourceArn arn:aws:sns:us-east-2:123456789012:MyTopic Use in a SQS queue resource policy to allow SNS to send message to the queue. Since principal is sns in this case, without the condition it can lead to the [[confused deputy problem]]. SourceAccount SourceOrgPaths SourceOrgID UserAgent Refer AWS docs\nExamples Not working\n\"Condition\": {\"StringEquals\": {\"aws:TagKeys\": [\"Department\"]}} Working\n\"Condition\": {\"ForAllValues:StringEquals\": {\"aws:TagKeys\": [\"Department\"]}} Working\n\"Condition\": {\"ForAnyValue:StringEquals\": {\"aws:TagKeys\": [\"Department\"]}} Managed Policy Refer https://docs.aws.amazon.com/aws-managed-policy/latest/reference/policy-list.html\n","wordCount":"339","inLanguage":"en","datePublished":"2024-02-15T00:00:00Z","dateModified":"2025-04-04T12:48:24+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://abiydv.github.io/notes/aws/iam/"},"publisher":{"@type":"Organization","name":"@abiydv","logo":{"@type":"ImageObject","url":"https://abiydv.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://abiydv.github.io/ accesskey=h title="@abiydv (Alt + H)">@abiydv</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://abiydv.github.io/ title=Home><span>Home</span></a></li><li><a href=https://abiydv.github.io/about/ title=About><span>About</span></a></li><li><a href=https://abiydv.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://abiydv.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://abiydv.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://abiydv.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://abiydv.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://abiydv.github.io/notes/>Notes</a>&nbsp;»&nbsp;<a href=https://abiydv.github.io/notes/aws/>AWS</a></div><h1 class=post-title>AWS Identity and Access Management (IAM)<sup>&nbsp;<span class="entry-stage sandbox">&nbsp;sandbox&nbsp;</span></sup></h1><div class=post-meta><s>15.2.24</s>&nbsp;4.4.25 / Notes / 2 min</div></header><div class=post-content><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#access-analyzer aria-label="Access Analyzer">Access Analyzer</a></li><li><a href=#identity-center aria-label="Identity Center">Identity Center</a></li><li><a href=#policy-conditions aria-label="Policy Conditions">Policy Conditions</a><ul><li><a href=#global-keys aria-label="Global Keys">Global Keys</a></li><li><a href=#examples aria-label=Examples>Examples</a></li></ul></li><li><a href=#managed-policy aria-label="Managed Policy">Managed Policy</a></li></ul></div></details></div></div><div class=post-content><h1 id=access-analyzer>Access Analyzer<a hidden class=anchor aria-hidden=true href=#access-analyzer>#</a></h1><p><a href=https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/>https://aws.amazon.com/blogs/security/how-to-prioritize-iam-access-analyzer-findings/</a></p><p>In addition to roles, it also analyzes resource policies on supported resources</p><p>Monitors resources for external access
AWS Simple Storage(S3) buckets
AWS Identity and Access Management roles
AWS Key Management Service Keys
AWS Lambda functions and layers
AWS Simple Queue Service queues
AWS Secrets Manager secrets</p><h1 id=identity-center>Identity Center<a hidden class=anchor aria-hidden=true href=#identity-center>#</a></h1><p>SSO for Org</p><h1 id=policy-conditions>Policy Conditions<a hidden class=anchor aria-hidden=true href=#policy-conditions>#</a></h1><p>Useful to allow/deny actions based on certain conditions in addition to resource arn or patterns.</p><p>Can be used for ABAC</p><p>Tag based access control</p><p>Use the <a href=https://docs.aws.amazon.com/service-authorization/latest/reference/reference.html>Service Authorization</a> page to find which service or actions support which condition keys.</p><p>Context keys can be single valued or multi valued, more <a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-single-vs-multi-valued-context-keys.html>here</a></p><p><a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition_operators.html>Condition Operators</a></p><p>Evaluation logic - AND, OR conditions</p><p><img loading=lazy src=https://docs.aws.amazon.com/images/IAM/latest/UserGuide/images/AccessPolicyLanguage_Condition_Block_AND_2.diagram.png alt=iam-condition-evaluation></p><h2 id=global-keys>Global Keys<a hidden class=anchor aria-hidden=true href=#global-keys>#</a></h2><p>These are available for most services and actions</p><p>All keys need an <code>aws:</code> suffix unless the prefix is specifically mentioned for a condition, liek <code>ec2:RoleDelivery</code></p><table><thead><tr><th>Principal</th><th>Example Value</th><th>Why use it?</th><th>Notes</th></tr></thead><tbody><tr><td><code>PrincipalArn</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalAccount</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalOrgPaths</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalOrgID</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalTag/TagKey</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalIsAWSService</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalServiceName</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalServiceNamesList</code></td><td></td><td></td><td></td></tr><tr><td><code>PrincipalType</code></td><td></td><td></td><td></td></tr><tr><td><code>userid</code></td><td></td><td></td><td></td></tr><tr><td><code>username</code></td><td></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>Role Session</th><th>Example Value</th><th>Why use it?</th><th>Notes</th></tr></thead><tbody><tr><td><code>FederatedProvider</code></td><td></td><td></td><td></td></tr><tr><td><code>TokenIssueTime</code></td><td></td><td></td><td></td></tr><tr><td><code>MultiFactorAuthPresent</code></td><td></td><td></td><td></td></tr><tr><td><code>Ec2InstanceSourceVpc</code></td><td></td><td></td><td></td></tr><tr><td><code>Ec2InstanceSourcePrivateIPv4</code></td><td></td><td></td><td></td></tr><tr><td><code>SourceIdentity</code></td><td></td><td></td><td></td></tr><tr><td><code>ec2:RoleDelivery</code></td><td></td><td></td><td></td></tr><tr><td><code>ec2:SourceInstanceArn</code></td><td></td><td></td><td></td></tr><tr><td><code>glue:RoleAssumedBy</code></td><td></td><td></td><td></td></tr><tr><td><code>glue:CredentialIssuingService</code></td><td></td><td></td><td></td></tr><tr><td><code>lambda:SourceFunctionArn</code></td><td></td><td></td><td></td></tr><tr><td><code>ssm:SourceInstanceArn</code></td><td></td><td></td><td></td></tr><tr><td><code>identitystore:UserId</code></td><td></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>Network</th><th>Example Value</th><th>Why use it?</th><th>Notes</th></tr></thead><tbody><tr><td><code>SourceIp</code></td><td></td><td></td><td></td></tr><tr><td><code>SourceVpc</code></td><td></td><td></td><td></td></tr><tr><td><code>SourceVpce</code></td><td></td><td></td><td></td></tr><tr><td><code>VpcSourceIp</code></td><td></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>Resource Properties</th><th>Example Value</th><th>Why use it?</th><th>Notes</th></tr></thead><tbody><tr><td><code>ResourceAccount</code></td><td></td><td></td><td></td></tr><tr><td><code>ResourceOrgPaths</code></td><td></td><td></td><td></td></tr><tr><td><code>ResourceOrgID</code></td><td></td><td></td><td></td></tr><tr><td><code>ResourceTag/TagKey</code></td><td></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>Request Properties</th><th>Example Values</th><th>Why use it?</th></tr></thead><tbody><tr><td><code>CalledVia</code></td><td></td><td></td></tr><tr><td><code>CalledViaFirst</code></td><td></td><td></td></tr><tr><td><code>CalledViaLast</code></td><td></td><td></td></tr><tr><td><code>ViaAWSService</code></td><td></td><td></td></tr><tr><td><code>CurrentTime</code></td><td></td><td></td></tr><tr><td><code>EpochTime</code></td><td></td><td></td></tr><tr><td><code>referer</code></td><td></td><td></td></tr><tr><td><code>RequestedRegion</code></td><td><code>us-east-1</code></td><td>Implement region deny controls by using this condition in an IAM policy or an SCP</td></tr><tr><td><code>RequestTag/TagKey</code></td><td></td><td>Implement standard tags. Deny action if tag not present. Not all resources support request tags (RDS doesn&rsquo;t!), so needs to be applied with other controls.</td></tr><tr><td><code>TagKeys</code></td><td></td><td></td></tr><tr><td><code>SecureTransport</code></td><td><code>true</code>, <code>false</code></td><td>Implement encryption-in-transit by denying actions which do not have this enable.</td></tr><tr><td><code>SourceArn</code></td><td><code>arn:aws:sns:us-east-2:123456789012:MyTopic</code></td><td>Use in a SQS queue resource policy to allow SNS to send message to the queue. Since principal is <code>sns</code> in this case, without the condition it can lead to the [[confused deputy problem]].</td></tr><tr><td><code>SourceAccount</code></td><td></td><td></td></tr><tr><td><code>SourceOrgPaths</code></td><td></td><td></td></tr><tr><td><code>SourceOrgID</code></td><td></td><td></td></tr><tr><td><code>UserAgent</code></td><td></td><td></td></tr></tbody></table><p>Refer <a href=https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-tagkeys>AWS docs</a></p><h2 id=examples>Examples<a hidden class=anchor aria-hidden=true href=#examples>#</a></h2><p><em>Not working</em></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;Condition&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {<span style=color:#f92672>&#34;StringEquals&#34;</span>: {<span style=color:#f92672>&#34;aws:TagKeys&#34;</span>: [<span style=color:#e6db74>&#34;Department&#34;</span>]}}
</span></span></code></pre></div><p>Working</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;Condition&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {<span style=color:#f92672>&#34;ForAllValues:StringEquals&#34;</span>: {<span style=color:#f92672>&#34;aws:TagKeys&#34;</span>: [<span style=color:#e6db74>&#34;Department&#34;</span>]}}
</span></span></code></pre></div><p>Working</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;Condition&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {<span style=color:#f92672>&#34;ForAnyValue:StringEquals&#34;</span>: {<span style=color:#f92672>&#34;aws:TagKeys&#34;</span>: [<span style=color:#e6db74>&#34;Department&#34;</span>]}}
</span></span></code></pre></div><h1 id=managed-policy>Managed Policy<a hidden class=anchor aria-hidden=true href=#managed-policy>#</a></h1><p>Refer <a href=https://docs.aws.amazon.com/aws-managed-policy/latest/reference/policy-list.html>https://docs.aws.amazon.com/aws-managed-policy/latest/reference/policy-list.html</a></p></div><footer class=post-footer><hr><div class=align-center><div class=slimlist-entry><h2>Topics</h2></div><ul class=post-tags><div class=slimlist-entry><li class=post-tags><a href=https://abiydv.github.io/topics/aws/>aws</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/stage-sandbox/>stage/sandbox</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/identity/>identity</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/security/>security</a></li></div></ul></div></footer><script src=https://utteranc.es/client.js repo=abiydv/abiydv.github.io issue-term=title label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2019-2025 <a href=https://abiydv.github.io/>@abiydv</a> / </span><span>Published 4.4.25 /
</span><span>Thanks <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>, <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>