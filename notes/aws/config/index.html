<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>AWS Config | @abiydv</title>
<meta name=keywords content><meta name=description content="What is it? AWS Config records and saves configuration of supported resources.
You can use these records to audit whether the resources align to best practices, or org specific patterns/rules. It can also highlight 2-way relationships between different resources. For ex - an instance is related to a vpc, a subnet, and a security group. This relation will show up in both the instance, and vpc records under relationships.
Resource Schema https://github."><meta name=author content><link rel=canonical href=https://abiydv.github.io/notes/aws/config/><link crossorigin=anonymous href=/assets/css/stylesheet.c5edd088d0c984c192170cfbab7d2de030010ee0b7d771bd6bca049dd2332874.css integrity="sha256-xe3QiNDJhMGSFwz7q30t4DABDuC313G9a8oEndIzKHQ=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://abiydv.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://abiydv.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://abiydv.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://abiydv.github.io/apple-touch-icon.png><link rel=mask-icon href=https://abiydv.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://abiydv.github.io/notes/aws/config/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="AWS Config"><meta property="og:description" content="What is it? AWS Config records and saves configuration of supported resources.
You can use these records to audit whether the resources align to best practices, or org specific patterns/rules. It can also highlight 2-way relationships between different resources. For ex - an instance is related to a vpc, a subnet, and a security group. This relation will show up in both the instance, and vpc records under relationships.
Resource Schema https://github."><meta property="og:type" content="article"><meta property="og:url" content="https://abiydv.github.io/notes/aws/config/"><meta property="article:section" content="notes"><meta property="article:published_time" content="2024-02-15T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-04T12:48:24+01:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="AWS Config"><meta name=twitter:description content="What is it? AWS Config records and saves configuration of supported resources.
You can use these records to audit whether the resources align to best practices, or org specific patterns/rules. It can also highlight 2-way relationships between different resources. For ex - an instance is related to a vpc, a subnet, and a security group. This relation will show up in both the instance, and vpc records under relationships.
Resource Schema https://github."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://abiydv.github.io/notes/"},{"@type":"ListItem","position":2,"name":"AWS","item":"https://abiydv.github.io/notes/aws/"},{"@type":"ListItem","position":3,"name":"AWS Config","item":"https://abiydv.github.io/notes/aws/config/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"AWS Config","name":"AWS Config","description":"What is it? AWS Config records and saves configuration of supported resources.\nYou can use these records to audit whether the resources align to best practices, or org specific patterns/rules. It can also highlight 2-way relationships between different resources. For ex - an instance is related to a vpc, a subnet, and a security group. This relation will show up in both the instance, and vpc records under relationships.\nResource Schema https://github.","keywords":[],"articleBody":"What is it? AWS Config records and saves configuration of supported resources.\nYou can use these records to audit whether the resources align to best practices, or org specific patterns/rules. It can also highlight 2-way relationships between different resources. For ex - an instance is related to a vpc, a subnet, and a security group. This relation will show up in both the instance, and vpc records under relationships.\nResource Schema https://github.com/awslabs/aws-config-resource-schema/tree/master\nAdvanced Query Run a sql like query against the records in AWS Config. It does not support some query types.\nIf you run the query against an aggregator you can query for resources across multiple accounts, even your entire organization.\nThis only works for current state query - does not work for historical search.\nNot supported advanced query limitations wildcard matches beginning with a wildcard character or having character sequences of less than length 3 are unsupported configuration.publicDnsName like “%11-12-13-14%” will not work configuration.publicDnsName like “11%” will not work configuration.publicDnsName like “ec2-11-12-13-14%” will work No way to kick off an on-demand evaluation of organization config rule without doing this for each account individually CloudFormation drift detection is not supported for config recorders and delivery channels Examples List all tags of instances in specific account SELECT resourceId, awsRegion, tags WHERE resourceType = 'AWS::EC2::Instance' AND accountId = '12345678912' List all instances with a specific private IP note: configuration.networkInterfaces is an array, so all elements are searched. configuration.networkInterfaces.privateIpAddress will be an array of ip addresses as found\nSELECT resourceId, resourceType, configuration.instanceType, configuration.placement.tenancy, configuration.networkInterfaces.privateIpAddress, configuration.imageId, availabilityZone WHERE resourceType = 'AWS::EC2::Instance' AND configuration.networkInterfaces.privateIpAddress = '1.1.1.1' public ip SELECT resourceId, resourceType, configuration.instanceType, configuration.placement.tenancy, configuration.imageId, availabilityZone WHERE configuration.ServerHostname = 'ec2-11-12-13-14.compute-1.amazonaws.com' Search for instances with a specific tag select resourceId, tags where resourceType = 'AWS::EC2::Instance' and tags.key = 'Owner' and tags.value = 'bruce.wayne' Wildcard search for instances select resourceId, tags.tag where resourceType = 'AWS::EC2::Instance' and tags.tag like 'Owner=bruce%' # matches bruce.wayne, bruce.willis Find all RDS instances not running with rds-ca-rsa2048-g1 CA SELECT configuration.cACertificateIdentifier, resourceId, resourceName, accountId, awsRegion, tags.tag WHERE resourceType = 'AWS::RDS::DBInstance' and configuration.cACertificateIdentifier != 'rds-ca-rsa2048-g1' Find all resources created in an account between specific dates select resourceType, count(*) where accountId = '123456789000' and configurationItemCaptureTime between '2024-01-01T00:00:000Z' and '2024-02-01T00:00:000Z' GROUP BY resourceType Find all buckets in 2 accounts select resourceId where accountId in ('123456789001', '123456789002') and resourceType = 'AWS::S3::Bucket' Find all security groups which contain a particular cidr range Note: CIDR notation is converted to IP ranges for search. This means that “=” and “BETWEEN” search for any range that includes the provided IP, instead of for an exact one. To search for an exact IP range, you need to add in additional conditions to exclude IPs outside of the range.\nSELECT * WHERE resourceType = 'AWS::EC2::SecurityGroup' AND configuration.ipPermissions.ipRanges BETWEEN '10.0.0.0' AND '10.0.0.255' AND NOT configuration.ipPermissions.ipRanges \u003c '10.0.0.0' AND NOT configuration.ipPermissions.ipRanges \u003e '10.0.0.255' Aggregator Aggregates resource records from different accounts and regions. A default set up is done by [[AWS Control Tower]], if you don’t want to set it up from scratch yourself.\nConformance Packs Recorder Delivery Channel Rules What is a rule? Triggers Custom rules Implement custom rules in Lambda to validate the resource record.\nManaged rules Use AWS managed rules to validate the resource record. Full list of managed rules is here.\nRecord software changes on EC2 You can use AWS Config to record software inventory changes on Amazon EC2 instances and on-premises servers\nTurn on recording for the managed instance inventory resource type in AWS Config. Configure EC2 and on-premises servers as managed instances in AWS Systems Manager. A managed instance is a machine that has been configured for use with Systems Manager. Initiate collection of software inventory from your managed instances using the Systems Manager Inventory capability. References https://docs.aws.amazon.com/config/latest/developerguide/aggregate-data.html https://docs.aws.amazon.com/config/latest/developerguide/querying-AWS-resources.html ","wordCount":"618","inLanguage":"en","datePublished":"2024-02-15T00:00:00Z","dateModified":"2025-04-04T12:48:24+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://abiydv.github.io/notes/aws/config/"},"publisher":{"@type":"Organization","name":"@abiydv","logo":{"@type":"ImageObject","url":"https://abiydv.github.io/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://abiydv.github.io/ accesskey=h title="@abiydv (Alt + H)">@abiydv</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://abiydv.github.io/ title=Home><span>Home</span></a></li><li><a href=https://abiydv.github.io/about/ title=About><span>About</span></a></li><li><a href=https://abiydv.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://abiydv.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://abiydv.github.io/notes/ title=Notes><span>Notes</span></a></li><li><a href=https://abiydv.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://abiydv.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://abiydv.github.io/notes/>Notes</a>&nbsp;»&nbsp;<a href=https://abiydv.github.io/notes/aws/>AWS</a></div><h1 class=post-title>AWS Config<sup>&nbsp;<span class="entry-stage sandbox">&nbsp;sandbox&nbsp;</span></sup></h1><div class=post-meta><s>15.2.24</s>&nbsp;4.4.25 / Notes / 3 min</div></header><div class=post-content><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-is-it aria-label="What is it?">What is it?</a></li><li><a href=#resource-schema aria-label="Resource Schema">Resource Schema</a></li><li><a href=#advanced-query aria-label="Advanced Query">Advanced Query</a><ul><li><a href=#not-supported aria-label="Not supported">Not supported</a></li><li><a href=#examples aria-label=Examples>Examples</a><ul><li><a href=#list-all-tags-of-instances-in-specific-account aria-label="List all tags of instances in specific account">List all tags of instances in specific account</a></li><li><a href=#list-all-instances-with-a-specific-private-ip aria-label="List all instances with a specific private IP">List all instances with a specific private IP</a></li><li><a href=#public-ip aria-label="public ip">public ip</a></li><li><a href=#search-for-instances-with-a-specific-tag aria-label="Search for instances with a specific tag">Search for instances with a specific tag</a></li><li><a href=#wildcard-search-for-instances aria-label="Wildcard search for instances">Wildcard search for instances</a></li><li><a href=#find-all-rds-instances-not-running-with-rds-ca-rsa2048-g1-ca aria-label="Find all RDS instances not running with rds-ca-rsa2048-g1 CA">Find all RDS instances not running with <code>rds-ca-rsa2048-g1</code> CA</a></li><li><a href=#find-all-resources-created-in-an-account-between-specific-dates aria-label="Find all resources created in an account between specific dates">Find all resources created in an account between specific dates</a></li><li><a href=#find-all-buckets-in-2-accounts aria-label="Find all buckets in 2 accounts">Find all buckets in 2 accounts</a></li><li><a href=#find-all-security-groups-which-contain-a-particular-cidr-range aria-label="Find all security groups which contain a particular cidr range">Find all security groups which contain a particular cidr range</a></li></ul></li></ul></li><li><a href=#aggregator aria-label=Aggregator>Aggregator</a></li><li><a href=#conformance-packs aria-label="Conformance Packs">Conformance Packs</a></li><li><a href=#recorder aria-label=Recorder>Recorder</a></li><li><a href=#delivery-channel aria-label="Delivery Channel">Delivery Channel</a></li><li><a href=#rules aria-label=Rules>Rules</a><ul><li><a href=#what-is-a-rule aria-label="What is a rule?">What is a rule?</a></li><li><a href=#triggers aria-label=Triggers>Triggers</a></li><li><a href=#custom-rules aria-label="Custom rules">Custom rules</a></li><li><a href=#managed-rules aria-label="Managed rules">Managed rules</a></li></ul></li><li><a href=#record-software-changes-on-ec2 aria-label="Record software changes on EC2">Record software changes on EC2</a><ul><li><a href=#references aria-label=References>References</a></li></ul></li></ul></div></details></div></div><div class=post-content><h1 id=what-is-it>What is it?<a hidden class=anchor aria-hidden=true href=#what-is-it>#</a></h1><p>AWS Config records and saves configuration of <a href=https://docs.aws.amazon.com/config/latest/developerguide/resource-config-reference.html>supported resources</a>.</p><p>You can use these records to audit whether the resources align to best practices, or org specific patterns/rules. It can also highlight 2-way relationships between different resources. For ex - an instance is related to a vpc, a subnet, and a security group. This relation will show up in both the instance, and vpc records under <code>relationships</code>.</p><h1 id=resource-schema>Resource Schema<a hidden class=anchor aria-hidden=true href=#resource-schema>#</a></h1><p><a href=https://github.com/awslabs/aws-config-resource-schema/tree/master>https://github.com/awslabs/aws-config-resource-schema/tree/master</a></p><h1 id=advanced-query>Advanced Query<a hidden class=anchor aria-hidden=true href=#advanced-query>#</a></h1><p>Run a sql <em>like</em> query against the records in AWS Config. It does not support some query types.</p><p>If you run the query against an aggregator you can query for resources across multiple accounts, even your entire organization.</p><p>This only works for current state query - does not work for historical search.</p><h2 id=not-supported>Not supported<a hidden class=anchor aria-hidden=true href=#not-supported>#</a></h2><ul><li>advanced query limitations<ul><li>wildcard matches beginning with a wildcard character or having character sequences of less than length 3 are unsupported</li><li>configuration.publicDnsName like &ldquo;%11-12-13-14%&rdquo; will not work</li><li>configuration.publicDnsName like &ldquo;11%&rdquo; will not work</li><li>configuration.publicDnsName like &ldquo;ec2-11-12-13-14%&rdquo; will work</li></ul></li><li>No way to kick off an on-demand evaluation of organization config rule without doing this for each account individually</li><li><a href=/notes/aws/cloudformation/#drift-detection>CloudFormation drift detection</a> is not supported for config <a href=/notes/aws/config/#recorder>recorders</a> and <a href=/notes/aws/config/#delivery-channel>delivery channels</a></li></ul><h2 id=examples>Examples<a hidden class=anchor aria-hidden=true href=#examples>#</a></h2><h3 id=list-all-tags-of-instances-in-specific-account>List all tags of instances in specific account<a hidden class=anchor aria-hidden=true href=#list-all-tags-of-instances-in-specific-account>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  resourceId,
</span></span><span style=display:flex><span>  awsRegion,
</span></span><span style=display:flex><span>  tags
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>  resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::EC2::Instance&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> accountId <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;12345678912&#39;</span>
</span></span></code></pre></div><h3 id=list-all-instances-with-a-specific-private-ip>List all instances with a specific private IP<a hidden class=anchor aria-hidden=true href=#list-all-instances-with-a-specific-private-ip>#</a></h3><p>note: configuration.networkInterfaces is an array, so all elements are searched.
configuration.networkInterfaces.privateIpAddress will be an array of ip addresses as found</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  resourceId,
</span></span><span style=display:flex><span>  resourceType,
</span></span><span style=display:flex><span>  configuration.instanceType,
</span></span><span style=display:flex><span>  configuration.placement.tenancy,
</span></span><span style=display:flex><span>  configuration.networkInterfaces.privateIpAddress,
</span></span><span style=display:flex><span>  configuration.imageId,
</span></span><span style=display:flex><span>  availabilityZone
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>  resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::EC2::Instance&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> configuration.networkInterfaces.privateIpAddress <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1.1.1.1&#39;</span>
</span></span></code></pre></div><h3 id=public-ip>public ip<a hidden class=anchor aria-hidden=true href=#public-ip>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  resourceId,
</span></span><span style=display:flex><span>  resourceType,
</span></span><span style=display:flex><span>  configuration.instanceType,
</span></span><span style=display:flex><span>  configuration.placement.tenancy,
</span></span><span style=display:flex><span>  configuration.imageId,
</span></span><span style=display:flex><span>  availabilityZone
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>  configuration.ServerHostname <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ec2-11-12-13-14.compute-1.amazonaws.com&#39;</span>
</span></span></code></pre></div><h3 id=search-for-instances-with-a-specific-tag>Search for instances with a specific tag<a hidden class=anchor aria-hidden=true href=#search-for-instances-with-a-specific-tag>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span>
</span></span><span style=display:flex><span>  resourceId,
</span></span><span style=display:flex><span>  tags
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span>
</span></span><span style=display:flex><span>  resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::EC2::Instance&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> tags.<span style=color:#66d9ef>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Owner&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> tags.value <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;bruce.wayne&#39;</span>
</span></span></code></pre></div><h3 id=wildcard-search-for-instances>Wildcard search for instances<a hidden class=anchor aria-hidden=true href=#wildcard-search-for-instances>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span>
</span></span><span style=display:flex><span>  resourceId,
</span></span><span style=display:flex><span>  tags.tag
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span>
</span></span><span style=display:flex><span>  resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::EC2::Instance&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> tags.tag <span style=color:#66d9ef>like</span> <span style=color:#e6db74>&#39;Owner=bruce%&#39;</span> <span style=color:#f92672>#</span> matches bruce.wayne, bruce.willis
</span></span></code></pre></div><h3 id=find-all-rds-instances-not-running-with-rds-ca-rsa2048-g1-ca>Find all RDS instances not running with <code>rds-ca-rsa2048-g1</code> CA<a hidden class=anchor aria-hidden=true href=#find-all-rds-instances-not-running-with-rds-ca-rsa2048-g1-ca>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span>
</span></span><span style=display:flex><span>  configuration.cACertificateIdentifier,
</span></span><span style=display:flex><span>  resourceId,
</span></span><span style=display:flex><span>  resourceName,
</span></span><span style=display:flex><span>  accountId,
</span></span><span style=display:flex><span>  awsRegion,
</span></span><span style=display:flex><span>  tags.tag
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span>
</span></span><span style=display:flex><span>  resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::RDS::DBInstance&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> configuration.cACertificateIdentifier <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;rds-ca-rsa2048-g1&#39;</span>
</span></span></code></pre></div><h3 id=find-all-resources-created-in-an-account-between-specific-dates>Find all resources created in an account between specific dates<a hidden class=anchor aria-hidden=true href=#find-all-resources-created-in-an-account-between-specific-dates>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span>
</span></span><span style=display:flex><span>  resourceType,
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>count</span>(<span style=color:#f92672>*</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span>
</span></span><span style=display:flex><span>  accountId <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;123456789000&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> configurationItemCaptureTime <span style=color:#66d9ef>between</span> <span style=color:#e6db74>&#39;2024-01-01T00:00:000Z&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> <span style=color:#e6db74>&#39;2024-02-01T00:00:000Z&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span>
</span></span><span style=display:flex><span>  resourceType
</span></span></code></pre></div><h3 id=find-all-buckets-in-2-accounts>Find all buckets in 2 accounts<a hidden class=anchor aria-hidden=true href=#find-all-buckets-in-2-accounts>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>select</span>
</span></span><span style=display:flex><span>  resourceId
</span></span><span style=display:flex><span><span style=color:#66d9ef>where</span>
</span></span><span style=display:flex><span>  accountId <span style=color:#66d9ef>in</span> (<span style=color:#e6db74>&#39;123456789001&#39;</span>, <span style=color:#e6db74>&#39;123456789002&#39;</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>and</span> resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::S3::Bucket&#39;</span>
</span></span></code></pre></div><h3 id=find-all-security-groups-which-contain-a-particular-cidr-range>Find all security groups which contain a particular cidr range<a hidden class=anchor aria-hidden=true href=#find-all-security-groups-which-contain-a-particular-cidr-range>#</a></h3><p>Note: CIDR notation is converted to IP ranges for search. This means that &ldquo;=&rdquo; and &ldquo;BETWEEN&rdquo; search for any range that includes the provided IP, instead of for an exact one. To search for an exact IP range, you need to add in additional conditions to exclude IPs outside of the range.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>WHERE</span> resourceType <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;AWS::EC2::SecurityGroup&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> configuration.ipPermissions.ipRanges <span style=color:#66d9ef>BETWEEN</span> <span style=color:#e6db74>&#39;10.0.0.0&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> <span style=color:#e6db74>&#39;10.0.0.255&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>NOT</span> configuration.ipPermissions.ipRanges <span style=color:#f92672>&lt;</span> <span style=color:#e6db74>&#39;10.0.0.0&#39;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>AND</span> <span style=color:#66d9ef>NOT</span> configuration.ipPermissions.ipRanges <span style=color:#f92672>&gt;</span> <span style=color:#e6db74>&#39;10.0.0.255&#39;</span>
</span></span></code></pre></div><h1 id=aggregator>Aggregator<a hidden class=anchor aria-hidden=true href=#aggregator>#</a></h1><p><em>Aggregates</em> resource records from different accounts and regions. A default set up is done by [[AWS Control Tower]], if you don&rsquo;t want to set it up from scratch yourself.</p><h1 id=conformance-packs>Conformance Packs<a hidden class=anchor aria-hidden=true href=#conformance-packs>#</a></h1><h1 id=recorder>Recorder<a hidden class=anchor aria-hidden=true href=#recorder>#</a></h1><h1 id=delivery-channel>Delivery Channel<a hidden class=anchor aria-hidden=true href=#delivery-channel>#</a></h1><h1 id=rules>Rules<a hidden class=anchor aria-hidden=true href=#rules>#</a></h1><h2 id=what-is-a-rule>What is a rule?<a hidden class=anchor aria-hidden=true href=#what-is-a-rule>#</a></h2><h2 id=triggers>Triggers<a hidden class=anchor aria-hidden=true href=#triggers>#</a></h2><h2 id=custom-rules>Custom rules<a hidden class=anchor aria-hidden=true href=#custom-rules>#</a></h2><p>Implement custom rules in <a href=/notes/aws/lambda/>Lambda</a> to validate the resource record.</p><h2 id=managed-rules>Managed rules<a hidden class=anchor aria-hidden=true href=#managed-rules>#</a></h2><p>Use AWS managed rules to validate the resource record. Full list of managed rules is <a href=https://docs.aws.amazon.com/config/latest/developerguide/managed-rules-by-aws-config.html>here</a>.</p><h1 id=record-software-changes-on-ec2>Record software changes on EC2<a hidden class=anchor aria-hidden=true href=#record-software-changes-on-ec2>#</a></h1><p>You can use AWS Config to record software inventory changes on Amazon EC2 instances and on-premises servers</p><ul><li>Turn on recording for the managed instance inventory resource type in AWS Config.</li><li>Configure EC2 and on-premises servers as <em>managed instances</em> in AWS Systems Manager. A managed instance is a machine that has been configured for use with Systems Manager.</li><li>Initiate collection of software inventory from your managed instances using the Systems Manager Inventory capability.</li></ul><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://docs.aws.amazon.com/config/latest/developerguide/aggregate-data.html>https://docs.aws.amazon.com/config/latest/developerguide/aggregate-data.html</a></li><li><a href=https://docs.aws.amazon.com/config/latest/developerguide/querying-AWS-resources.html>https://docs.aws.amazon.com/config/latest/developerguide/querying-AWS-resources.html</a></li></ul></div><footer class=post-footer><hr><div class=align-center><div class=slimlist-entry><h2>Topics</h2></div><ul class=post-tags><div class=slimlist-entry><li class=post-tags><a href=https://abiydv.github.io/topics/aws/>aws</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/stage-sandbox/>stage/sandbox</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/governance/>governance</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/audit/>audit</a></li><li class=post-tags><a href=https://abiydv.github.io/topics/security/>security</a></li></div></ul></div></footer><script src=https://utteranc.es/client.js repo=abiydv/abiydv.github.io issue-term=title label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2019-2025 <a href=https://abiydv.github.io/>@abiydv</a> / </span><span>Published 4.4.25 /
</span><span>Thanks <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>, <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>